!function(){"use strict";angular.module("ngGeolocation",[]).factory("$geolocation",["$rootScope","$window","$q",function(o,t,i){function n(){return"geolocation"in t.navigator}var e={getCurrentPosition:function(r){var a=i.defer();return n()?t.navigator.geolocation.getCurrentPosition(function(t){o.$apply(function(){e.position.coords=t.coords,e.position.timestamp=t.timestamp,a.resolve(t)})},function(t){o.$apply(function(){a.reject({error:t})})},r):a.reject({error:{code:2,message:"This web browser does not support HTML5 Geolocation"}}),a.promise},watchPosition:function(i){n()?this.watchId||(this.watchId=t.navigator.geolocation.watchPosition(function(t){o.$apply(function(){e.position.coords=t.coords,e.position.timestamp=t.timestamp,delete e.position.error,o.$broadcast("$geolocation.position.changed",t)})},function(t){o.$apply(function(){e.position.error=t,delete e.position.coords,delete e.position.timestamp,o.$broadcast("$geolocation.position.error",t)})},i)):e.position={error:{code:2,message:"This web browser does not support HTML5 Geolocation"}}},clearWatch:function(){this.watchId&&(t.navigator.geolocation.clearWatch(this.watchId),delete this.watchId)},position:{}};return e}])}();