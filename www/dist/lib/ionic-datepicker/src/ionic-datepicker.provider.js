angular.module("ionic-datepicker.provider",[]).provider("ionicDatePicker",function(){var e={setLabel:"Set",todayLabel:"Today",closeLabel:"Close",inputDate:new Date,mondayFirst:!0,weeksList:["S","M","T","W","T","F","S"],monthsList:["Jan","Feb","March","April","May","June","July","Aug","Sept","Oct","Nov","Dec"],templateType:"popup",showTodayButton:!1,closeOnSelect:!1,disableWeekdays:[]};this.configDatePicker=function(t){angular.extend(e,t)},this.$get=["$rootScope","$ionicPopup","$ionicModal","IonicDatepickerService",function(t,a,n,o){function i(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function s(e){e.disabledDates&&0!==e.disabledDates.length?(m.disabledDates=[],angular.forEach(e.disabledDates,function(e,t){e=i(new Date(e)),m.disabledDates.push(e.getTime())})):m.disabledDates=[]}function r(e){e=i(e),m.currentDate=angular.copy(e);var t=new Date(e.getFullYear(),e.getMonth(),1).getDate(),a=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();m.monthsList=[],m.mainObj.monthsList&&12===m.mainObj.monthsList.length?m.monthsList=m.mainObj.monthsList:m.monthsList=o.monthsList,m.yearsList=o.getYearsList(m.mainObj.from,m.mainObj.to),m.dayList=[];var n,s;m.firstDayEpoch=i(new Date(e.getFullYear(),e.getMonth(),t)).getTime(),m.lastDayEpoch=i(new Date(e.getFullYear(),e.getMonth(),a)).getTime();for(var r=t;r<=a;r++)n=new Date(e.getFullYear(),e.getMonth(),r),s=n.getTime()<m.fromDate||n.getTime()>m.toDate||m.mainObj.disableWeekdays.indexOf(n.getDay())>=0,m.dayList.push({date:n.getDate(),month:n.getMonth(),year:n.getFullYear(),day:n.getDay(),epoch:n.getTime(),disabled:s});var c=m.dayList[0].day-m.mainObj.mondayFirst;c=c<0?6:c;for(var l=0;l<c;l++)m.dayList.unshift({});m.rows=[0,7,14,21,28,35],m.cols=[0,1,2,3,4,5,6],m.data.currentMonth=m.mainObj.monthsList[e.getMonth()],m.data.currentYear=e.getFullYear(),m.data.currentMonthSelected=angular.copy(m.data.currentMonth),m.currentYearSelected=angular.copy(m.data.currentYear),m.numColumns=7}function c(e){m.mainObj=angular.copy(e),m.selctedDateEpoch=i(m.mainObj.inputDate).getTime(),m.mainObj.weeksList&&7===m.mainObj.weeksList.length?m.weeksList=m.mainObj.weeksList:m.weeksList=["S","M","T","W","T","F","S"],m.mainObj.mondayFirst&&m.weeksList.push(m.mainObj.weeksList.shift()),m.disableWeekdays=m.mainObj.disableWeekdays,r(m.mainObj.inputDate),s(m.mainObj)}function l(){m.modal.show()}function u(){m.modal.hide()}var d={},m=t.$new();return m.today=i(new Date).getTime(),m.disabledDates=[],m.data={},m.prevMonth=function(){1===m.currentDate.getMonth()&&m.currentDate.setFullYear(m.currentDate.getFullYear()),m.currentDate.setMonth(m.currentDate.getMonth()-1),m.data.currentMonth=m.mainObj.monthsList[m.currentDate.getMonth()],m.data.currentYear=m.currentDate.getFullYear(),r(m.currentDate)},m.nextMonth=function(){11===m.currentDate.getMonth()&&m.currentDate.setFullYear(m.currentDate.getFullYear()),m.currentDate.setDate(1),m.currentDate.setMonth(m.currentDate.getMonth()+1),m.data.currentMonth=m.mainObj.monthsList[m.currentDate.getMonth()],m.data.currentYear=m.currentDate.getFullYear(),r(m.currentDate)},m.dateSelected=function(e){e&&0!==Object.keys(e).length&&(m.selctedDateEpoch=e.epoch,m.mainObj.closeOnSelect&&(m.mainObj.callback(m.selctedDateEpoch),"popup"==m.mainObj.templateType.toLowerCase()?m.popup.close():u()))},m.setIonicDatePickerTodayDate=function(){var e=new Date;r(new Date),m.selctedDateEpoch=i(e).getTime(),m.mainObj.closeOnSelect&&(m.mainObj.callback(m.selctedDateEpoch),u())},m.setIonicDatePickerDate=function(){m.mainObj.callback(m.selctedDateEpoch),u()},m.monthChanged=function(e){var t=m.monthsList.indexOf(e);m.currentDate.setMonth(t),r(m.currentDate)},m.yearChanged=function(e){m.currentDate.setFullYear(e),r(m.currentDate)},n.fromTemplateUrl("ionic-datepicker-modal.html",{scope:m,animation:"slide-in-up"}).then(function(e){m.modal=e}),m.$on("$destroy",function(){m.modal.remove()}),m.closeIonicDatePickerModal=function(){u()},d.openDatePicker=function(t){var n=[];delete m.fromDate,delete m.toDate,m.mainObj=angular.extend({},e,t),m.mainObj.from&&(m.fromDate=i(new Date(m.mainObj.from)).getTime()),m.mainObj.to&&(m.toDate=i(new Date(m.mainObj.to)).getTime()),t.disableWeekdays&&e.disableWeekdays&&(m.mainObj.disableWeekdays=t.disableWeekdays.concat(e.disableWeekdays)),c(m.mainObj),m.mainObj.closeOnSelect||(n=[{text:m.mainObj.setLabel,type:"button_set",onTap:function(e){m.mainObj.callback(m.selctedDateEpoch)}}]),m.mainObj.showTodayButton&&n.push({text:m.mainObj.todayLabel,type:"button_today",onTap:function(e){var t=new Date;r(new Date),m.selctedDateEpoch=i(t).getTime(),m.mainObj.closeOnSelect||e.preventDefault()}}),n.push({text:m.mainObj.closeLabel,type:"button_close",onTap:function(e){console.log("ionic-datepicker popup closed.")}}),"popup"==m.mainObj.templateType.toLowerCase()?m.popup=a.show({templateUrl:"ionic-datepicker-popup.html",scope:m,cssClass:"ionic_datepicker_popup",buttons:n}):l()},d}]});