/*!
*  ui-leaflet 1.0.1 2016-06-08
*  ui-leaflet - An AngularJS directive to easily interact with Leaflet maps
*  git: https://github.com/angular-ui/ui-leaflet
*/
!function(angular){"use strict";angular.module("ui-leaflet",["nemLogging"]).directive("leaflet",["$q","leafletData","leafletMapDefaults","leafletHelpers","leafletMapEvents",function(e,r,a,t,n){return{restrict:"EA",replace:!0,scope:{center:"=",lfCenter:"=",defaults:"=",maxbounds:"=",bounds:"=",markers:"=",legend:"=",geojson:"=",paths:"=",tiles:"=",layers:"=",controls:"=",decorations:"=",eventBroadcast:"=",markersWatchOptions:"=",geojsonWatchOptions:"="},transclude:!0,template:'<div class="angular-leaflet-map"><div ng-transclude></div></div>',controller:["$scope",function(r){this._leafletMap=e.defer(),this.getMap=function(){return this._leafletMap.promise},this.getLeafletScope=function(){return r}}],link:function(e,o,i,l){function s(){isNaN(i.width)?o.css("width",i.width):o.css("width",i.width+"px")}function u(){isNaN(i.height)?o.css("height",i.height):o.css("height",i.height+"px")}var c=t.isDefined,d=a.setDefaults(e.defaults,i.id),f=n.getAvailableMapEvents(),p=n.addEvents;e.mapId=i.id,r.setDirectiveControls({},i.id),c(i.width)&&(s(),e.$watch(function(){return o[0].getAttribute("width")},function(){s(),g.invalidateSize()})),c(i.height)&&(u(),e.$watch(function(){return o[0].getAttribute("height")},function(){u(),g.invalidateSize()}));var g=new L.Map(o[0],a.getMapCreationDefaults(i.id));if(l._leafletMap.resolve(g),c(i.center)||c(i.lfCenter)||g.setView([d.center.lat,d.center.lng],d.center.zoom),!c(i.tiles)&&!c(i.layers)){var y=L.tileLayer(d.tileLayer,d.tileLayerOptions);y.addTo(g),r.setTiles(y,i.id)}if(c(g.zoomControl)&&c(d.zoomControlPosition)&&g.zoomControl.setPosition(d.zoomControlPosition),c(g.zoomControl)&&d.zoomControl===!1&&g.zoomControl.removeFrom(g),c(g.zoomsliderControl)&&c(d.zoomsliderControl)&&d.zoomsliderControl===!1&&g.zoomsliderControl.removeFrom(g),!c(i.eventBroadcast)){var v="broadcast";p(g,f,"eventName",e,v)}g.whenReady(function(){r.setMap(g,i.id)}),e.$on("$destroy",function(){a.reset(),g.remove(),r.unresolveMap(i.id)}),e.$on("invalidateSize",function(){g.invalidateSize()})}}}]),angular.module("ui-leaflet").factory("leafletBoundsHelpers",["leafletLogger","leafletHelpers",function(e,r){function a(e){return angular.isDefined(e)&&angular.isDefined(e.southWest)&&angular.isDefined(e.northEast)&&angular.isNumber(e.southWest.lat)&&angular.isNumber(e.southWest.lng)&&angular.isNumber(e.northEast.lat)&&angular.isNumber(e.northEast.lng)}var t=r.isArray,n=r.isNumber,o=r.isFunction,i=r.isDefined,l=e;return{createLeafletBounds:function(e){if(a(e))return L.latLngBounds([e.southWest.lat,e.southWest.lng],[e.northEast.lat,e.northEast.lng])},isValidBounds:a,createBoundsFromArray:function(e){return t(e)&&2===e.length&&t(e[0])&&t(e[1])&&2===e[0].length&&2===e[1].length&&n(e[0][0])&&n(e[0][1])&&n(e[1][0])&&n(e[1][1])?{northEast:{lat:e[0][0],lng:e[0][1]},southWest:{lat:e[1][0],lng:e[1][1]}}:void l.error("[AngularJS - Leaflet] The bounds array is not valid.")},createBoundsFromLeaflet:function(e){if(!(i(e)&&o(e.getNorthEast)&&o(e.getSouthWest)))return void l.error("[AngularJS - Leaflet] The leaflet bounds is not valid object.");var r=e.getNorthEast(),a=e.getSouthWest();return{northEast:{lat:r.lat,lng:r.lng},southWest:{lat:a.lat,lng:a.lng}}}}}]),angular.module("ui-leaflet").factory("leafletControlHelpers",["$rootScope","leafletLogger","leafletHelpers","leafletLayerHelpers","leafletMapDefaults",function(e,r,a,t,n){var o=a.isDefined,i=a.isObject,l=t.createLayer,s={},u=a.errorHeader+" [Controls] ",c=r,d=function(e,r,a){var t=n.getDefaults(a);if(!t.controls.layers.visible)return!1;var l=!1;return i(e)&&Object.keys(e).forEach(function(r){var a=e[r];o(a.layerOptions)&&a.layerOptions.showOnSelector===!1||(l=!0)}),i(r)&&Object.keys(r).forEach(function(e){var a=r[e];o(a.layerParams)&&a.layerParams.showOnSelector===!1||(l=!0)}),l},f=function(e){var r=n.getDefaults(e),a={collapsed:r.controls.layers.collapsed,position:r.controls.layers.position,autoZIndex:!1};angular.extend(a,r.controls.layers.options);var t;return t=r.controls.layers&&o(r.controls.layers.control)?r.controls.layers.control.apply(this,[[],[],a]):new L.control.layers([],[],a)},p={draw:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Draw)||(c.error(u+" Draw plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Draw(e)}},scale:{isPluginLoaded:function(){return!0},checkValidParams:function(){return!0},createControl:function(e){return new L.control.scale(e)}},fullscreen:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Fullscreen)||(c.error(u+" Fullscreen plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Fullscreen(e)}},search:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.Search)||(c.error(u+" Search plugin is not loaded."),!1)},checkValidParams:function(){return!0},createControl:function(e){return new L.Control.Search(e)}},custom:{},minimap:{isPluginLoaded:function(){return!!angular.isDefined(L.Control.MiniMap)||(c.error(u+" Minimap plugin is not loaded."),!1)},checkValidParams:function(e){return!!o(e.layer)||(c.warn(u+' minimap "layer" option should be defined.'),!1)},createControl:function(e){var r=l(e.layer);return o(r)?new L.Control.MiniMap(r,e):void c.warn(u+' minimap control "layer" could not be created.')}}};return{layersControlMustBeVisible:d,isValidControlType:function(e){return Object.keys(p).indexOf(e)!==-1},createControl:function(e,r){if(p[e].checkValidParams(r))return p[e].createControl(r)},updateLayersControl:function(e,r,a,t,n,i){var l,u=s[r],c=d(t,n,r);if(o(u)&&a){for(l in i.baselayers)u.removeLayer(i.baselayers[l]);for(l in i.overlays)u.removeLayer(i.overlays[l]);e.removeControl(u),delete s[r]}if(c){u=f(r),s[r]=u;for(l in t){var p=o(t[l].layerOptions)&&t[l].layerOptions.showOnSelector===!1;!p&&o(i.baselayers[l])&&u.addBaseLayer(i.baselayers[l],t[l].name)}for(l in n){var g=o(n[l].layerParams)&&n[l].layerParams.showOnSelector===!1;!g&&o(i.overlays[l])&&u.addOverlay(i.overlays[l],n[l].name)}e.addControl(u)}return c}}}]),angular.module("ui-leaflet").service("leafletData",["leafletLogger","$q","leafletHelpers",function(e,r,a){var t=a.getDefer,n=a.getUnresolvedDefer,o=a.setResolvedDefer,i={},l=this,s=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},u=["map","tiles","layers","paths","markers","geoJSON","UTFGrid","decorations","directiveControls"];u.forEach(function(e){i[e]={}}),this.unresolveMap=function(e){var r=a.obtainEffectiveMapId(i.map,e);u.forEach(function(e){i[e][r]=void 0})},u.forEach(function(e){var r=s(e);l["set"+r]=function(r,a){var t=n(i[e],a);t.resolve(r),o(i[e],a)},l["get"+r]=function(r){var a=t(i[e],r);return a.promise}})}]),angular.module("ui-leaflet").service("leafletDirectiveControlsHelpers",["leafletLogger","leafletData","leafletHelpers",function(e,r,a){var t=a.isDefined,n=a.isString,o=a.isObject,i=a.errorHeader,l=e,s=i+"[leafletDirectiveControlsHelpers",u=function(e,a,i,u){var c=s+".extend] ",d={};if(!t(a))return void l.error(c+"thingToAddName cannot be undefined");if(n(a)&&t(i)&&t(u))d[a]={create:i,clean:u};else{if(!o(a)||t(i)||t(u))return void l.error(c+"incorrect arguments");d=a}r.getDirectiveControls(e).then(function(a){angular.extend(a,d),r.setDirectiveControls(a,e)})};return{extend:u}}]),angular.module("ui-leaflet").service("leafletGeoJsonHelpers",["leafletHelpers","leafletIterators",function(e,r){var a=e,t=r,n=function(e,r){return this.lat=e,this.lng=r,this},o=function(e){return Array.isArray(e)&&2===e.length?e[1]:a.isDefined(e.type)&&"Point"===e.type?+e.coordinates[1]:+e.lat},i=function(e){return Array.isArray(e)&&2===e.length?e[0]:a.isDefined(e.type)&&"Point"===e.type?+e.coordinates[0]:+e.lng},l=function(e){if(a.isUndefined(e))return!1;if(a.isArray(e)){if(2===e.length&&a.isNumber(e[0])&&a.isNumber(e[1]))return!0}else if(a.isDefined(e.type)&&"Point"===e.type&&a.isArray(e.coordinates)&&2===e.coordinates.length&&a.isNumber(e.coordinates[0])&&a.isNumber(e.coordinates[1]))return!0;var r=t.all(["lat","lng"],function(r){return a.isDefined(e[r])&&a.isNumber(e[r])});return r},s=function(e){if(e&&l(e)){var r=null;if(Array.isArray(e)&&2===e.length)r=new n(e[1],e[0]);else{if(!a.isDefined(e.type)||"Point"!==e.type)return e;r=new n(e.coordinates[1],e.coordinates[0])}return angular.extend(e,r)}};return{getLat:o,getLng:i,validateCoords:l,getCoords:s}}]),angular.module("ui-leaflet").service("leafletHelpers",["$q","$log",function(e,r){function a(e,r){var a,t=Object.keys(e);if(angular.isDefined(r))a=r;else{if(0!==t.length&&(1!==t.length||"main"!==t[0]))throw new Error(n+"- You have more than 1 map on the DOM, you must provide the map ID to the leafletData.getXXX call. Where one of the following mapIds "+Object.keys(e).join(",")+" are available.");a="main"}return a}function t(r,t){var n,o=a(r,t);return angular.isDefined(r[o])&&r[o].resolvedDefer!==!0?n=r[o].defer:(n=e.defer(),r[o]={defer:n,resolvedDefer:!1}),n}var n="[AngularJS - Leaflet] ",o=angular.copy,i=o,l=function(e,r){var a;if(e&&angular.isObject(e))return null!==r&&angular.isString(r)?(a=e,r.split(".").forEach(function(e){a&&(a=a[e])}),a):r},s=function(e){return e.split(".").reduce(function(e,r){return e+'["'+r+'"]'})},u=function(e){return e.reduce(function(e,r){return e+"."+r})},c=function(e){return angular.isDefined(e)&&null!==e},d=function(e){return!c(e)},f=/([\:\-\_]+(.))/g,p=/^moz([A-Z])/,g=/^((?:x|data)[\:\-_])/i,y=function(e){return e.replace(f,function(e,r,a,t){return t?a.toUpperCase():a}).replace(p,"Moz$1")},v=function(e){return y(e.replace(g,""))};return{camelCase:y,directiveNormalize:v,copy:o,clone:i,errorHeader:n,getObjectValue:l,getObjectArrayPath:s,getObjectDotPath:u,defaultTo:function(e,r){return c(e)?e:r},isTruthy:function(e){return"true"===e||e===!0},isEmpty:function(e){return 0===Object.keys(e).length},isUndefinedOrEmpty:function(e){return angular.isUndefined(e)||null===e||0===Object.keys(e).length},isDefined:c,isUndefined:d,isNumber:angular.isNumber,isString:angular.isString,isArray:angular.isArray,isObject:angular.isObject,isFunction:angular.isFunction,equals:angular.equals,isValidCenter:function(e){return angular.isDefined(e)&&angular.isNumber(e.lat)&&angular.isNumber(e.lng)&&angular.isNumber(e.zoom)},isValidPoint:function(e){return!!angular.isDefined(e)&&(angular.isArray(e)?2===e.length&&angular.isNumber(e[0])&&angular.isNumber(e[1]):angular.isNumber(e.lat)&&angular.isNumber(e.lng))},isSameCenterOnMap:function(e,r){var a=r.getCenter(),t=r.getZoom();return!(!e.lat||!e.lng||a.lat.toFixed(4)!==e.lat.toFixed(4)||a.lng.toFixed(4)!==e.lng.toFixed(4)||t!==e.zoom)},safeApply:function(e,r){var a=e.$root.$$phase;"$apply"===a||"$digest"===a?e.$eval(r):e.$evalAsync(r)},obtainEffectiveMapId:a,getDefer:function(e,r){var n,o=a(e,r);return n=angular.isDefined(e[o])&&e[o].resolvedDefer!==!1?e[o].defer:t(e,r)},getUnresolvedDefer:t,setResolvedDefer:function(e,r){var t=a(e,r);e[t].resolvedDefer=!0},rangeIsSupported:function(){var e=document.createElement("input");return e.setAttribute("type","range"),"range"===e.type},FullScreenControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.Fullscreen)}},MiniMapControlPlugin:{isLoaded:function(){return angular.isDefined(L.Control.MiniMap)}},AwesomeMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.AwesomeMarkers)&&angular.isDefined(L.AwesomeMarkers.Icon)},is:function(e){return!!this.isLoaded()&&e instanceof L.AwesomeMarkers.Icon},equal:function(e,r){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,r))}},VectorMarkersPlugin:{isLoaded:function(){return angular.isDefined(L.VectorMarkers)&&angular.isDefined(L.VectorMarkers.Icon)},is:function(e){return!!this.isLoaded()&&e instanceof L.VectorMarkers.Icon},equal:function(e,r){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,r))}},DomMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.DomMarkers)||!angular.isDefined(L.DomMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.DomMarkers.Icon},equal:function(e,r){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,r))}},PolylineDecoratorPlugin:{isLoaded:function(){return!!angular.isDefined(L.PolylineDecorator)},is:function(e){return!!this.isLoaded()&&e instanceof L.PolylineDecorator},equal:function(e,r){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,r))}},MakiMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.MakiMarkers)||!angular.isDefined(L.MakiMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.MakiMarkers.Icon},equal:function(e,r){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,r))}},ExtraMarkersPlugin:{isLoaded:function(){return!(!angular.isDefined(L.ExtraMarkers)||!angular.isDefined(L.ExtraMarkers.Icon))},is:function(e){return!!this.isLoaded()&&e instanceof L.ExtraMarkers.Icon},equal:function(e,r){return!!this.isLoaded()&&(!!this.is(e)&&angular.equals(e,r))}},LabelPlugin:{isLoaded:function(){return angular.isDefined(L.Label)},is:function(e){return!!this.isLoaded()&&e instanceof L.MarkerClusterGroup}},MarkerClusterPlugin:{isLoaded:function(){return angular.isDefined(L.MarkerClusterGroup)},is:function(e){return!!this.isLoaded()&&e instanceof L.MarkerClusterGroup}},GoogleLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Google)},is:function(e){return!!this.isLoaded()&&e instanceof L.Google}},LeafletProviderPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.Provider)},is:function(e){return!!this.isLoaded()&&e instanceof L.TileLayer.Provider}},ChinaLayerPlugin:{isLoaded:function(){return angular.isDefined(L.tileLayer.chinaProvider)}},HeatLayerPlugin:{isLoaded:function(){return angular.isDefined(L.heatLayer)}},WebGLHeatMapLayerPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.WebGLHeatMap)}},BingLayerPlugin:{isLoaded:function(){return angular.isDefined(L.BingLayer)},is:function(e){return!!this.isLoaded()&&e instanceof L.BingLayer}},WFSLayerPlugin:{isLoaded:function(){return void 0!==L.GeoJSON.WFS},is:function(e){return!!this.isLoaded()&&e instanceof L.GeoJSON.WFS}},AGSBaseLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.basemapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.basemapLayer}},AGSLayerPlugin:{isLoaded:function(){return void 0!==lvector&&void 0!==lvector.AGS},is:function(e){return!!this.isLoaded()&&e instanceof lvector.AGS}},AGSFeatureLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.featureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.featureLayer}},AGSTiledMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.tiledMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.tiledMapLayer}},AGSDynamicMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.dynamicMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.dynamicMapLayer}},AGSImageMapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.imageMapLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.imageMapLayer}},AGSClusteredLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.clusteredFeatureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.clusteredFeatureLayer}},AGSHeatmapLayerPlugin:{isLoaded:function(){return void 0!==L.esri&&void 0!==L.esri.heatmapFeatureLayer},is:function(e){return!!this.isLoaded()&&e instanceof L.esri.heatmapFeatureLayer}},YandexLayerPlugin:{isLoaded:function(){return angular.isDefined(L.Yandex)},is:function(e){return!!this.isLoaded()&&e instanceof L.Yandex}},GeoJSONPlugin:{isLoaded:function(){return angular.isDefined(L.TileLayer.GeoJSON)},is:function(e){return!!this.isLoaded()&&e instanceof L.TileLayer.GeoJSON}},UTFGridPlugin:{isLoaded:function(){return angular.isDefined(L.UtfGrid)},is:function(e){return this.isLoaded()?e instanceof L.UtfGrid:(r.error("[AngularJS - Leaflet] No UtfGrid plugin found."),!1)}},CartoDB:{isLoaded:function(){return cartodb},is:function(){return!0}},Leaflet:{DivIcon:{is:function(e){return e instanceof L.DivIcon},equal:function(e,r){return!!this.is(e)&&angular.equals(e,r)}},Icon:{is:function(e){return e instanceof L.Icon},equal:function(e,r){return!!this.is(e)&&angular.equals(e,r)}}},watchOptions:{doWatch:!0,isDeep:!0,individual:{doWatch:!0,isDeep:!0}}}}]),angular.module("ui-leaflet").service("leafletIterators",["leafletLogger","leafletHelpers",function(e,r){var a,t=r,n=r.errorHeader+"leafletIterators: ",o=Object.keys,i=t.isFunction,l=t.isObject,s=e,u=Math.pow(2,53)-1,c=function(e){var r=null!==e&&e.length;return t.isNumber(r)&&r>=0&&r<=u},d=function(e){return e},f=function(e){return function(r){return null===r?void 0:r[e]}},p=function(e,r,a){if(void 0===r)return e;switch(null===a?3:a){case 1:return function(a){return e.call(r,a)};case 2:return function(a,t){return e.call(r,a,t)};case 3:return function(a,t,n){return e.call(r,a,t,n)};case 4:return function(a,t,n,o){return e.call(r,a,t,n,o)}}return function(){return e.apply(r,arguments)}},g=function(e,r){return function(a){var t=arguments.length;if(t<2||null===a)return a;for(var n=1;n<t;n++)for(var o=arguments[n],i=e(o),l=i.length,s=0;s<l;s++){var u=i[s];r&&void 0!==a[u]||(a[u]=o[u])}return a}},y=null;a=y=g(o);var v,m=function(e,r){var a=o(r),t=a.length;if(null===e)return!t;for(var n=Object(e),i=0;i<t;i++){var l=a[i];if(r[l]!==n[l]||!(l in n))return!1}return!0},L=null;v=L=function(e){return e=a({},e),function(r){return m(r,e)}};var h,b=function(e,r,a){return null===e?d:i(e)?p(e,r,a):l(e)?v(e):f(e)},k=null;h=k=function(e,r,a){r=b(r,a);for(var t=!c(e)&&o(e),n=(t||e).length,i=0;i<n;i++){var l=t?t[i]:i;if(!r(e[l],l,e))return!1}return!0};var A=function(e,r,a,o){return!(a||t.isDefined(e)&&t.isDefined(r))||!t.isFunction(r)&&(o=t.defaultTo(r,"cb"),s.error(n+o+" is not a function"),!0)},D=function(e,r,a){if(!A(void 0,a,!0,"internalCb")&&!A(e,r))for(var t in e)e.hasOwnProperty(t)&&a(e[t],t)},w=function(e,r){D(e,r,function(e,a){r(e,a)})};return{each:w,forEach:w,every:h,all:k}}]),angular.module("ui-leaflet").factory("leafletLayerHelpers",["$rootScope","$q","leafletLogger","leafletHelpers","leafletIterators",function($rootScope,$q,leafletLogger,leafletHelpers,leafletIterators){function isValidLayerType(e){return isString(e.type)?Object.keys(layerTypes).indexOf(e.type)===-1?($log.error("[AngularJS - Leaflet] A layer must have a valid type: "+Object.keys(layerTypes)),!1):layerTypes[e.type].mustHaveUrl&&!isString(e.url)?($log.error("[AngularJS - Leaflet] A base layer must have an url"),!1):layerTypes[e.type].mustHaveData&&!isDefined(e.data)?($log.error('[AngularJS - Leaflet] The base layer must have a "data" array attribute'),!1):layerTypes[e.type].mustHaveLayer&&!isDefined(e.layer)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have an layer defined"),!1):layerTypes[e.type].mustHaveBounds&&!isDefined(e.bounds)?($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have bounds defined"),!1):!(layerTypes[e.type].mustHaveKey&&!isDefined(e.key))||($log.error("[AngularJS - Leaflet] The type of layer "+e.type+" must have key defined"),!1):($log.error("[AngularJS - Leaflet] A layer must have a valid type defined."),!1)}function createLayer(e){if(isValidLayerType(e)){if(!isString(e.name))return void $log.error("[AngularJS - Leaflet] A base layer must have a name");isObject(e.layerParams)||(e.layerParams={}),isObject(e.layerOptions)||(e.layerOptions={});for(var r in e.layerParams)e.layerOptions[r]=e.layerParams[r];var a={url:e.url,data:e.data,options:e.layerOptions,layer:e.layer,icon:e.icon,type:e.layerType,bounds:e.bounds,key:e.key,apiKey:e.apiKey,pluginOptions:e.pluginOptions,user:e.user};return layerTypes[e.type].createLayer(a)}}function safeAddLayer(e,r){r&&"function"==typeof r.addTo?r.addTo(e):e.addLayer(r)}function safeRemoveLayer(e,r,a){if(isDefined(a)&&isDefined(a.loadedDefer))if(angular.isFunction(a.loadedDefer)){var t=a.loadedDefer();$log.debug("Loaded Deferred",t);var n=t.length;if(n>0)for(var o=function(){n--,0===n&&e.removeLayer(r)},i=0;i<t.length;i++)t[i].promise.then(o);else e.removeLayer(r)}else a.loadedDefer.promise.then(function(){e.removeLayer(r)});else e.removeLayer(r)}var Helpers=leafletHelpers,isString=leafletHelpers.isString,isObject=leafletHelpers.isObject,isArray=leafletHelpers.isArray,isDefined=leafletHelpers.isDefined,errorHeader=leafletHelpers.errorHeader,$it=leafletIterators,$log=leafletLogger,utfGridCreateLayer=function(e){if(!Helpers.UTFGridPlugin.isLoaded())return void $log.error("[AngularJS - Leaflet] The UTFGrid plugin is not loaded.");var r=new L.UtfGrid(e.url,e.pluginOptions);return r.on("mouseover",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseover",e)}),r.on("mouseout",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMouseout",e)}),r.on("click",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridClick",e)}),r.on("mousemove",function(e){$rootScope.$broadcast("leafletDirectiveMap.utfgridMousemove",e)}),r},layerTypes={xyz:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer(e.url,e.options)}},mapbox:{mustHaveKey:!0,createLayer:function(e){var r=3;isDefined(e.options.version)&&4===e.options.version&&(r=e.options.version);var a=3===r?"//{s}.tiles.mapbox.com/v3/"+e.key+"/{z}/{x}/{y}.png":"//api.tiles.mapbox.com/v4/"+e.key+"/{z}/{x}/{y}.png?access_token="+e.apiKey;return L.tileLayer(a,e.options)}},geoJSON:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.GeoJSONPlugin.isLoaded())return new L.TileLayer.GeoJSON(e.url,e.pluginOptions,e.options)}},geoJSONShape:{mustHaveUrl:!1,createLayer:function(e){return new L.GeoJSON(e.data,e.options)}},geoJSONAwesomeMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(r,a){return L.marker(a,{icon:L.AwesomeMarkers.icon(e.icon)})}})}},geoJSONVectorMarker:{mustHaveUrl:!1,createLayer:function(e){return new L.geoJson(e.data,{pointToLayer:function(r,a){return L.marker(a,{icon:L.VectorMarkers.icon(e.icon)})}})}},utfGrid:{mustHaveUrl:!0,createLayer:utfGridCreateLayer},cartodbTiles:{mustHaveKey:!0,createLayer:function(e){var r="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png";return L.tileLayer(r,e.options)}},cartodbUTFGrid:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){return e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json",utfGridCreateLayer(e)}},cartodbInteractive:{mustHaveKey:!0,mustHaveLayer:!0,createLayer:function(e){var r="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/{z}/{x}/{y}.png",a=L.tileLayer(r,e.options);e.url="//"+e.user+".cartodb.com/api/v1/map/"+e.key+"/"+e.layer+"/{z}/{x}/{y}.grid.json";var t=utfGridCreateLayer(e);return L.layerGroup([a,t])}},wms:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wms(e.url,e.options)}},wmts:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.wmts(e.url,e.options)}},wfs:{mustHaveUrl:!0,mustHaveLayer:!0,createLayer:function(params){if(Helpers.WFSLayerPlugin.isLoaded()){var options=angular.copy(params.options);return options.crs&&"string"==typeof options.crs&&(options.crs=eval(options.crs)),new L.GeoJSON.WFS(params.url,params.layer,options)}}},group:{mustHaveUrl:!1,createLayer:function(e){var r=[];return $it.each(e.options.layers,function(e){r.push(createLayer(e))}),e.options.loadedDefer=function(){var r=[];if(isDefined(e.options.layers))for(var a=0;a<e.options.layers.length;a++){var t=e.options.layers[a].layerOptions.loadedDefer;isDefined(t)&&r.push(t)}return r},L.layerGroup(r)}},featureGroup:{mustHaveUrl:!1,createLayer:function(){return L.featureGroup()}},google:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"SATELLITE";if(Helpers.GoogleLayerPlugin.isLoaded())return new L.Google(r,e.options)}},here:{mustHaveUrl:!1,createLayer:function(e){var r=e.provider||"HERE.terrainDay";if(Helpers.LeafletProviderPlugin.isLoaded())return new L.TileLayer.Provider(r,e.options)}},china:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"";if(Helpers.ChinaLayerPlugin.isLoaded())return L.tileLayer.chinaProvider(r,e.options)}},agsBase:{mustHaveLayer:!0,createLayer:function(e){if(Helpers.AGSBaseLayerPlugin.isLoaded())return L.esri.basemapLayer(e.layer,e.options)}},ags:{mustHaveUrl:!0,createLayer:function(e){if(Helpers.AGSLayerPlugin.isLoaded()){var r=angular.copy(e.options);angular.extend(r,{url:e.url});var a=new lvector.AGS(r);return a.onAdd=function(e){this.setMap(e)},a.onRemove=function(){this.setMap(null)},a}}},agsFeature:{mustHaveUrl:!0,createLayer:function(e){if(!Helpers.AGSFeatureLayerPlugin.isLoaded())return void $log.warn(errorHeader+" The esri plugin is not loaded.");e.options.url=e.url;var r=L.esri.featureLayer(e.options),a=function(){isDefined(e.options.loadedDefer)&&e.options.loadedDefer.resolve()};return r.on("loading",function(){e.options.loadedDefer=$q.defer(),r.off("load",a),r.on("load",a)}),r}},agsTiled:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSTiledMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.tiledMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsDynamic:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSDynamicMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.dynamicMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsImage:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSImageMapLayerPlugin.isLoaded()?(e.options.url=e.url,L.esri.imageMapLayer(e.options)):void $log.warn(errorHeader+" The esri plugin is not loaded.")}},agsClustered:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSClusteredLayerPlugin.isLoaded()?Helpers.MarkerClusterPlugin.isLoaded()?L.esri.clusteredFeatureLayer(e.url,e.options):void $log.warn(errorHeader+" The markercluster plugin is not loaded."):void $log.warn(errorHeader+" The esri clustered layer plugin is not loaded.")}},agsHeatmap:{mustHaveUrl:!0,createLayer:function(e){return Helpers.AGSHeatmapLayerPlugin.isLoaded()?Helpers.HeatLayerPlugin.isLoaded()?L.esri.heatmapFeatureLayer(e.url,e.options):void $log.warn(errorHeader+" The heatlayer plugin is not loaded."):void $log.warn(errorHeader+" The esri heatmap layer plugin is not loaded.")}},markercluster:{mustHaveUrl:!1,createLayer:function(e){return Helpers.MarkerClusterPlugin.isLoaded()?new L.MarkerClusterGroup(e.options):void $log.warn(errorHeader+" The markercluster plugin is not loaded.")}},bing:{mustHaveUrl:!1,createLayer:function(e){if(Helpers.BingLayerPlugin.isLoaded())return new L.BingLayer(e.key,e.options)}},webGLHeatmap:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.WebGLHeatMapLayerPlugin.isLoaded()){var r=new L.TileLayer.WebGLHeatMap(e.options);return isDefined(e.data)&&r.setData(e.data),r}}},heat:{mustHaveUrl:!1,mustHaveData:!0,createLayer:function(e){if(Helpers.HeatLayerPlugin.isLoaded()){var r=new L.heatLayer;return isArray(e.data)&&r.setLatLngs(e.data),isObject(e.options)&&r.setOptions(e.options),r}}},yandex:{mustHaveUrl:!1,createLayer:function(e){var r=e.type||"map";if(Helpers.YandexLayerPlugin.isLoaded())return new L.Yandex(r,e.options)}},imageOverlay:{mustHaveUrl:!0,mustHaveBounds:!0,createLayer:function(e){return L.imageOverlay(e.url,e.bounds,e.options)}},iip:{mustHaveUrl:!0,createLayer:function(e){return L.tileLayer.iip(e.url,e.options)}},custom:{createLayer:function(e){return e.layer instanceof L.Class?angular.copy(e.layer):void $log.error("[AngularJS - Leaflet] A custom layer must be a leaflet Class")}},cartodb:{mustHaveUrl:!0,createLayer:function(e){return cartodb.createLayer(e.map,e.url)}}};return{createLayer:createLayer,safeAddLayer:safeAddLayer,safeRemoveLayer:safeRemoveLayer}}]),angular.module("ui-leaflet").factory("leafletLegendHelpers",["$http","$q","$log","leafletHelpers",function(e,r,a,t){var n={},o=t.isDefined,i=function(r){var a=n[r],t=a[0];e(t.c).then(function(e){a.shift(),t.d.resolve(e),a.length>0&&i(r)},function(e){a.shift(),t.d.reject(e),a.length>0&&i(r)})},l=function(e,r,a,t){if(e.innerHTML="",r.error)e.innerHTML+='<div class="info-title alert alert-danger">'+r.error.message+"</div>";else if("arcgis"===a)for(var n=0;n<r.layers.length;n++){var o=r.layers[n];e.innerHTML+='<div class="info-title" data-layerid="'+o.layerId+'">'+o.layerName+"</div>";for(var i=0;i<o.legend.length;i++){var l=o.legend[i];e.innerHTML+='<div class="inline" data-layerid="'+o.layerId+'"><img src="data:'+l.contentType+";base64,"+l.imageData+'" /></div><div class="info-label" data-layerid="'+o.layerId+'">'+l.label+"</div>"}}else"image"===a&&(e.innerHTML='<img src="'+t+'"/>')},s=function(e,r,a,t){return function(){var n=L.DomUtil.create("div",r);return L.Browser.touch?L.DomEvent.on(n,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(n),L.DomEvent.on(n,"mousewheel",L.DomEvent.stopPropagation)),l(n,e,a,t),n}},u=function(e,r){return function(){for(var a=L.DomUtil.create("div",r),t=0;t<e.colors.length;t++)a.innerHTML+='<div class="outline"><i style="background:'+e.colors[t]+'"></i></div><div class="info-label">'+e.labels[t]+"</div>";return L.Browser.touch?L.DomEvent.on(a,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(a),L.DomEvent.on(a,"mousewheel",L.DomEvent.stopPropagation)),a}};return{getOnAddLegend:s,getOnAddArrayLegend:u,updateLegend:l,addLegendURL:function(e,a){var t=r.defer();return o(n[e])||(n[e]=[]),n[e].push({c:a,d:t}),1===n[e].length&&i(e),t.promise}}}]),angular.module("ui-leaflet").factory("leafletMapDefaults",["$q","leafletHelpers",function(e,r){function a(){return{keyboard:!0,dragging:!0,worldCopyJump:!1,doubleClickZoom:!0,scrollWheelZoom:!0,tap:!0,touchZoom:!0,zoomControl:!0,zoomsliderControl:!1,zoomControlPosition:"topleft",attributionControl:!0,controls:{layers:{visible:!0,position:"topright",collapsed:!0}},nominatim:{server:" http://nominatim.openstreetmap.org/search"},crs:L.CRS.EPSG3857,tileLayer:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tileLayerOptions:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},path:{weight:10,opacity:1,color:"#0000ff"},center:{lat:0,lng:0,zoom:1}}}var t=r.isDefined,n=r.isObject,o=r.obtainEffectiveMapId,i={};return{reset:function(){i={}},getDefaults:function(e){var r=o(i,e);return i[r]},getMapCreationDefaults:function(e){var r=o(i,e),a=i[r],n={maxZoom:a.maxZoom,keyboard:a.keyboard,dragging:a.dragging,zoomControl:a.zoomControl,doubleClickZoom:a.doubleClickZoom,scrollWheelZoom:a.scrollWheelZoom,tap:a.tap,touchZoom:a.touchZoom,attributionControl:a.attributionControl,worldCopyJump:a.worldCopyJump,crs:a.crs};if(t(a.minZoom)&&(n.minZoom=a.minZoom),t(a.zoomAnimation)&&(n.zoomAnimation=a.zoomAnimation),t(a.fadeAnimation)&&(n.fadeAnimation=a.fadeAnimation),t(a.markerZoomAnimation)&&(n.markerZoomAnimation=a.markerZoomAnimation),a.map)for(var l in a.map)n[l]=a.map[l];return n},setDefaults:function(e,r){var l=a();t(e)&&(l.doubleClickZoom=t(e.doubleClickZoom)?e.doubleClickZoom:l.doubleClickZoom,l.scrollWheelZoom=t(e.scrollWheelZoom)?e.scrollWheelZoom:l.doubleClickZoom,l.tap=t(e.tap)?e.tap:l.tap,l.touchZoom=t(e.touchZoom)?e.touchZoom:l.doubleClickZoom,l.zoomControl=t(e.zoomControl)?e.zoomControl:l.zoomControl,l.zoomsliderControl=t(e.zoomsliderControl)?e.zoomsliderControl:l.zoomsliderControl,l.attributionControl=t(e.attributionControl)?e.attributionControl:l.attributionControl,l.tileLayer=t(e.tileLayer)?e.tileLayer:l.tileLayer,l.zoomControlPosition=t(e.zoomControlPosition)?e.zoomControlPosition:l.zoomControlPosition,l.keyboard=t(e.keyboard)?e.keyboard:l.keyboard,l.dragging=t(e.dragging)?e.dragging:l.dragging,t(e.controls)&&angular.extend(l.controls,e.controls),n(e.crs)?l.crs=e.crs:t(L.CRS[e.crs])&&(l.crs=L.CRS[e.crs]),t(e.center)&&angular.copy(e.center,l.center),t(e.tileLayerOptions)&&angular.copy(e.tileLayerOptions,l.tileLayerOptions),t(e.maxZoom)&&(l.maxZoom=e.maxZoom),t(e.minZoom)&&(l.minZoom=e.minZoom),t(e.zoomAnimation)&&(l.zoomAnimation=e.zoomAnimation),t(e.fadeAnimation)&&(l.fadeAnimation=e.fadeAnimation),t(e.markerZoomAnimation)&&(l.markerZoomAnimation=e.markerZoomAnimation),
t(e.worldCopyJump)&&(l.worldCopyJump=e.worldCopyJump),t(e.map)&&(l.map=e.map),t(e.path)&&(l.path=e.path));var s=o(i,r);return i[s]=l,l}}}]),angular.module("ui-leaflet").service("leafletMarkersHelpers",["$rootScope","$timeout","leafletHelpers","leafletLogger","$compile","leafletGeoJsonHelpers",function(e,r,a,t,n,o){var i=a.isDefined,l=a.defaultTo,s=a.MarkerClusterPlugin,u=a.AwesomeMarkersPlugin,c=a.VectorMarkersPlugin,d=a.MakiMarkersPlugin,f=a.ExtraMarkersPlugin,p=a.DomMarkersPlugin,g=a.safeApply,y=a,v=a.isString,m=a.isNumber,h=a.isObject,b={},k=o,A=a.errorHeader,D=t,w=function(e){var r="";return["_icon","_latlng","_leaflet_id","_map","_shadow"].forEach(function(a){r+=a+": "+l(e[a],"undefined")+" \n"}),"[leafletMarker] : \n"+r},P=function(e,r){var a=r?console:D;a.debug(w(e))},C=function(r){if(i(r)&&i(r.type)&&"awesomeMarker"===r.type)return u.isLoaded()||D.error(A+" The AwesomeMarkers Plugin is not loaded."),new L.AwesomeMarkers.icon(r);if(i(r)&&i(r.type)&&"vectorMarker"===r.type)return c.isLoaded()||D.error(A+" The VectorMarkers Plugin is not loaded."),new L.VectorMarkers.icon(r);if(i(r)&&i(r.type)&&"makiMarker"===r.type)return d.isLoaded()||D.error(A+"The MakiMarkers Plugin is not loaded."),new L.MakiMarkers.icon(r);if(i(r)&&i(r.type)&&"extraMarker"===r.type)return f.isLoaded()||D.error(A+"The ExtraMarkers Plugin is not loaded."),new L.ExtraMarkers.icon(r);if(i(r)&&i(r.type)&&"div"===r.type)return new L.divIcon(r);if(i(r)&&i(r.type)&&"dom"===r.type){p.isLoaded()||D.error(A+"The DomMarkers Plugin is not loaded.");var a=angular.isFunction(r.getMarkerScope)?r.getMarkerScope():e,t=n(r.template)(a),o=angular.copy(r);return o.element=t[0],new L.DomMarkers.icon(o)}if(i(r)&&i(r.type)&&"icon"===r.type)return r.icon;var l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII=";return i(r)&&i(r.iconUrl)?new L.Icon(r):new L.Icon.Default({iconUrl:l,shadowUrl:s,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},M=function(e){i(b[e])&&b.splice(e,1)},H=function(){b={}},O=function(e,r,a){if(e.closePopup(),i(a)&&i(a.overlays))for(var t in a.overlays)if((a.overlays[t]instanceof L.LayerGroup||a.overlays[t]instanceof L.FeatureGroup)&&a.overlays[t].hasLayer(e))return void a.overlays[t].removeLayer(e);if(i(b))for(var n in b)b[n].hasLayer(e)&&b[n].removeLayer(e);r.hasLayer(e)&&r.removeLayer(e)},S=function(e,r){var a=e._popup._container.offsetHeight,t=new L.Point(e._popup._containerLeft,-a-e._popup._containerBottom),n=r.layerPointToContainerPoint(t);null!==n&&e._popup._adjustPan()},E=function(e,r){n(e._popup._contentNode)(r)},T=function(e,a,t){var n=e._popup._contentNode.innerText||e._popup._contentNode.textContent;n.length<1&&r(function(){T(e,a,t)});var o=e._popup._contentNode.offsetWidth;return e._popup._updateLayout(),e._popup._updatePosition(),e._popup.options.autoPan&&S(e,t),o},x=function(r,a,t){var n=angular.isFunction(a.getMessageScope)?a.getMessageScope():e,o=!i(a.compileMessage)||a.compileMessage;if(o){if(!i(r._popup)||!i(r._popup._contentNode))return D.error(A+"Popup is invalid or does not have any content."),!1;E(r,n),T(r,a,t)}},B=function(r,a){var t=angular.isFunction(a.getMessageScope)?a.getMessageScope():e,o=angular.isFunction(a.getLabelScope)?a.getLabelScope():t,l=!i(a.compileMessage)||a.compileMessage;y.LabelPlugin.isLoaded()&&i(a.label)&&(i(a.label.options)&&a.label.options.noHide===!0&&r.showLabel(),l&&i(r.label)&&n(r.label._container)(o))},G=function(e,r,a,t,n,o,l){if(i(r)){if(!k.validateCoords(e))return D.warn("There are problems with lat-lng data, please verify your marker model"),void O(a,l,o);var s=e===r;if(i(e.iconAngle)&&r.iconAngle!==e.iconAngle&&a.setIconAngle(e.iconAngle),v(e.layer)||v(r.layer)&&(i(o.overlays[r.layer])&&o.overlays[r.layer].hasLayer(a)&&(o.overlays[r.layer].removeLayer(a),a.closePopup()),l.hasLayer(a)||l.addLayer(a)),(m(e.opacity)||m(parseFloat(e.opacity)))&&e.opacity!==r.opacity&&a.setOpacity(e.opacity),v(e.layer)&&r.layer!==e.layer){if(v(r.layer)&&i(o.overlays[r.layer])&&o.overlays[r.layer].hasLayer(a)&&o.overlays[r.layer].removeLayer(a),a.closePopup(),l.hasLayer(a)&&l.removeLayer(a),!i(o.overlays[e.layer]))return void D.error(A+"You must use a name of an existing layer");var u=o.overlays[e.layer];if(!(u instanceof L.LayerGroup||u instanceof L.FeatureGroup))return void D.error(A+'A marker can only be added to a layer of type "group" or "featureGroup"');u.addLayer(a),l.hasLayer(a)&&e.focus===!0&&a.openPopup()}if(e.draggable!==!0&&r.draggable===!0&&i(a.dragging)&&a.dragging.disable(),e.draggable===!0&&r.draggable!==!0&&(a.dragging?a.dragging.enable():L.Handler.MarkerDrag&&(a.dragging=new L.Handler.MarkerDrag(a),a.options.draggable=!0,a.dragging.enable())),h(e.icon)||h(r.icon)&&(a.setIcon(C()),a.closePopup(),a.unbindPopup(),v(e.message)&&a.bindPopup(e.message,e.popupOptions)),h(e.icon)&&h(r.icon)&&!angular.equals(e.icon,r.icon)){var c=!1;a.dragging&&(c=a.dragging.enabled()),a.setIcon(C(e.icon)),c&&a.dragging.enable(),a.closePopup(),a.unbindPopup(),v(e.message)&&(a.bindPopup(e.message,e.popupOptions),l.hasLayer(a)&&e.focus===!0&&a.openPopup())}!v(e.message)&&v(r.message)&&(a.closePopup(),a.unbindPopup()),y.LabelPlugin.isLoaded()&&(i(e.label)&&i(e.label.message)?"label"in r&&"message"in r.label&&!angular.equals(e.label.message,r.label.message)?a.updateLabelContent(e.label.message):!angular.isFunction(a.getLabel)||angular.isFunction(a.getLabel)&&!i(a.getLabel())?(a.bindLabel(e.label.message,e.label.options),B(a,e)):B(a,e):"label"in e&&!("message"in e.label)||angular.isFunction(a.unbindLabel)&&a.unbindLabel()),v(e.message)&&!v(r.message)&&a.bindPopup(e.message,e.popupOptions),v(e.message)&&v(r.message)&&e.message!==r.message&&a.setPopupContent(e.message);var d=!1;e.focus!==!0&&r.focus===!0&&(a.closePopup(),d=!0),(e.focus===!0&&(!i(r.focus)||r.focus===!1)||s&&e.focus===!0)&&(a.openPopup(),d=!0),r.zIndexOffset!==e.zIndexOffset&&a.setZIndexOffset(e.zIndexOffset);var f=a.getLatLng(),p=v(e.layer)&&y.MarkerClusterPlugin.is(o.overlays[e.layer]);p?d?e.lat===r.lat&&e.lng===r.lng||(o.overlays[e.layer].removeLayer(a),a.setLatLng([e.lat,e.lng]),o.overlays[e.layer].addLayer(a)):f.lat!==e.lat||f.lng!==e.lng?(o.overlays[e.layer].removeLayer(a),a.setLatLng([e.lat,e.lng]),o.overlays[e.layer].addLayer(a)):e.lat!==r.lat||e.lng!==r.lng?(o.overlays[e.layer].removeLayer(a),a.setLatLng([e.lat,e.lng]),o.overlays[e.layer].addLayer(a)):h(e.icon)&&h(r.icon)&&!angular.equals(e.icon,r.icon)&&(o.overlays[e.layer].removeLayer(a),o.overlays[e.layer].addLayer(a)):f.lat===e.lat&&f.lng===e.lng||a.setLatLng([e.lat,e.lng])}},F=function(e,r){if(i(e))return r?e[r]:e},$=function(e,r,a){if(i(e))return r?a?e[a][r]:e[r]:void D.error(A+"marker id missing in getMarker")};return{resetMarkerGroup:M,resetMarkerGroups:H,deleteMarker:O,manageOpenPopup:x,manageOpenLabel:B,createMarker:function(e){if(!i(e)||!k.validateCoords(e))return void D.error(A+"The marker definition is not valid.");var r=k.getCoords(e);if(!i(r))return void D.error(A+"Unable to get coordinates from markerData.");var a={icon:C(e.icon),title:i(e.title)?e.title:"",draggable:!!i(e.draggable)&&e.draggable,clickable:!i(e.clickable)||e.clickable,riseOnHover:!!i(e.riseOnHover)&&e.riseOnHover,zIndexOffset:i(e.zIndexOffset)?e.zIndexOffset:0,iconAngle:i(e.iconAngle)?e.iconAngle:0};for(var t in e)e.hasOwnProperty(t)&&!a.hasOwnProperty(t)&&(a[t]=e[t]);var n=new L.marker(r,a);return v(e.message)||n.unbindPopup(),n},addMarkerToGroup:function(e,r,a,t){return v(r)?s.isLoaded()?(i(b[r])||(b[r]=new L.MarkerClusterGroup(a),t.addLayer(b[r])),void b[r].addLayer(e)):void D.error(A+"The MarkerCluster plugin is not loaded."):void D.error(A+"The marker group you have specified is invalid.")},listenMarkerEvents:function(e,r,a,t,n){e.on("popupopen",function(){g(a,function(){(i(e._popup)||i(e._popup._contentNode))&&(r.focus=!0,x(e,r,n))})}),e.on("popupclose",function(){g(a,function(){r.focus=!1})}),e.on("add",function(){g(a,function(){"label"in r&&B(e,r)})})},updateMarker:G,addMarkerWatcher:function(e,r,a,t,n,o){var s=y.getObjectArrayPath("markers."+r);o=l(o,!0);var u=a.$watch(s,function(o,l){return i(o)?void G(o,l,e,r,a,t,n):(O(e,n,t),void u())},o)},string:w,log:P,getModelFromModels:$,getLayerModels:F}}]),angular.module("ui-leaflet").factory("leafletPathsHelpers",["$rootScope","leafletLogger","leafletHelpers",function(e,r,a){function t(e){return e.filter(function(e){return c(e)}).map(function(e){return n(e)})}function n(e){return s(e)?new L.LatLng(e[0],e[1]):new L.LatLng(e.lat,e.lng)}function o(e){return e.map(function(e){return t(e)})}function i(e,r){for(var a={},t=0;t<f.length;t++){var n=f[t];l(e[n])?a[n]=e[n]:l(r.path[n])&&(a[n]=r.path[n])}return a}var l=a.isDefined,s=a.isArray,u=a.isNumber,c=a.isValidPoint,d=r,f=["stroke","weight","color","opacity","fill","fillColor","fillOpacity","dashArray","lineCap","lineJoin","clickable","pointerEvents","className","smoothFactor","noClip"],p=function(e,r){for(var a={},t=0;t<f.length;t++){var n=f[t];l(r[n])&&(a[n]=r[n])}e.setStyle(r)},g=function(e){if(!s(e))return!1;for(var r=0;r<e.length;r++){var a=e[r];if(!c(a))return!1}return!0},y={polyline:{isValid:function(e){var r=e.latlngs;return g(r)},createPath:function(e){return new L.Polyline([],e)},setPath:function(e,r){e.setLatLngs(t(r.latlngs)),p(e,r)}},multiPolyline:{isValid:function(e){var r=e.latlngs;if(!s(r))return!1;for(var a in r){var t=r[a];if(!g(t))return!1}return!0},createPath:function(e){return new L.multiPolyline([[[0,0],[1,1]]],e)},setPath:function(e,r){e.setLatLngs(o(r.latlngs)),p(e,r)}},polygon:{isValid:function(e){var r=e.latlngs;return g(r)},createPath:function(e){return new L.Polygon([],e)},setPath:function(e,r){e.setLatLngs(t(r.latlngs)),p(e,r)}},multiPolygon:{isValid:function(e){var r=e.latlngs;if(!s(r))return!1;for(var a in r){var t=r[a];if(!g(t))return!1}return!0},createPath:function(e){return new L.MultiPolygon([[[0,0],[1,1],[0,1]]],e)},setPath:function(e,r){e.setLatLngs(o(r.latlngs)),p(e,r)}},rectangle:{isValid:function(e){var r=e.latlngs;if(!s(r)||2!==r.length)return!1;for(var a in r){var t=r[a];if(!c(t))return!1}return!0},createPath:function(e){return new L.Rectangle([[0,0],[1,1]],e)},setPath:function(e,r){e.setBounds(new L.LatLngBounds(t(r.latlngs))),p(e,r)}},circle:{isValid:function(e){var r=e.latlngs;return c(r)&&u(e.radius)},createPath:function(e){return new L.Circle([0,0],1,e)},setPath:function(e,r){e.setLatLng(n(r.latlngs)),l(r.radius)&&e.setRadius(r.radius),p(e,r)}},circleMarker:{isValid:function(e){var r=e.latlngs;return c(r)&&u(e.radius)},createPath:function(e){return new L.CircleMarker([0,0],e)},setPath:function(e,r){e.setLatLng(n(r.latlngs)),l(r.radius)&&e.setRadius(r.radius),p(e,r)}}},v=function(e){var r={};return e.latlngs&&(r.latlngs=e.latlngs),e.radius&&(r.radius=e.radius),r};return{setPathOptions:function(e,r,a){l(r)||(r="polyline"),y[r].setPath(e,a)},createPath:function(e,r,a){l(r.type)||(r.type="polyline");var t=i(r,a),n=v(r);return y[r.type].isValid(n)?y[r.type].createPath(t):void d.error("[AngularJS - Leaflet] Invalid data passed to the "+r.type+" path")}}}]),angular.module("ui-leaflet").service("leafletWatchHelpers",function(){var e=function(e,r,a,t,n){var o=e[r](a,function(e,r){n(e,r),t.doWatch||o()},t.isDeep);return o},r=function(r,a,t,n){return e(r,"$watch",a,t,n)},a=function(r,a,t,n){return e(r,"$watchCollection",a,t,n)};return{maybeWatch:r,maybeWatchCollection:a}}),angular.module("ui-leaflet").service("leafletLogger",["nemSimpleLogger",function(e){return e.spawn()}]),angular.module("ui-leaflet").factory("nominatimService",["$q","$http","leafletHelpers","leafletMapDefaults",function(e,r,a,t){var n=a.isDefined;return{query:function(a,o){var i=t.getDefaults(o),l=i.nominatim.server,s=e.defer();return r.get(l,{params:{format:"json",limit:1,q:a}}).success(function(e){e.length>0&&n(e[0].boundingbox)?s.resolve(e[0]):s.reject("[Nominatim] Invalid address")}),s.promise}}}]),angular.module("ui-leaflet").directive("bounds",["leafletLogger","$timeout","$http","leafletHelpers","nominatimService","leafletBoundsHelpers",function(e,r,a,t,n,o){var i=e;return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(e,a,l,s){var u=t.isDefined,c=o.createLeafletBounds,d=s[0].getLeafletScope(),f=s[0],p=t.errorHeader+" [Bounds] ",g=function(e){return 0===e._southWest.lat&&0===e._southWest.lng&&0===e._northEast.lat&&0===e._northEast.lng};f.getMap().then(function(a){d.$on("boundsChanged",function(e){var t=e.currentScope,n=a.getBounds();if(!g(n)&&!t.settingBoundsFromScope){t.settingBoundsFromLeaflet=!0;var o={northEast:{lat:n._northEast.lat,lng:n._northEast.lng},southWest:{lat:n._southWest.lat,lng:n._southWest.lng},options:n.options};angular.equals(t.bounds,o)||(t.bounds=o),r(function(){t.settingBoundsFromLeaflet=!1})}});var t;d.$watch("bounds",function(o){if(!e.settingBoundsFromLeaflet){if(u(o.address)&&o.address!==t)return e.settingBoundsFromScope=!0,n.query(o.address,l.id).then(function(e){var r=e.boundingbox,t=[[r[0],r[2]],[r[1],r[3]]];a.fitBounds(t)},function(e){i.error(p+" "+e+".")}),t=o.address,void r(function(){e.settingBoundsFromScope=!1});var s=c(o);s&&!a.getBounds().equals(s)&&(e.settingBoundsFromScope=!0,a.fitBounds(s,o.options),r(function(){e.settingBoundsFromScope=!1}))}},!0)})}}}]);var centerDirectiveTypes=["center","lfCenter"],centerDirectives={};centerDirectiveTypes.forEach(function(e){centerDirectives[e]=["leafletLogger","$q","$location","$timeout","leafletMapDefaults","leafletHelpers","leafletBoundsHelpers","leafletMapEvents",function(r,a,t,n,o,i,l,s){var u,c=i.isDefined,d=i.isNumber,f=i.isSameCenterOnMap,p=i.safeApply,g=i.isValidCenter,y=l.isValidBounds,v=i.isUndefinedOrEmpty,m=i.errorHeader,L=r,h=function(e,r){return c(e)&&y(e)&&v(r)};return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:function(){u=a.defer(),this.getCenter=function(){return u.promise}},link:function(r,a,i,y){var v=y.getLeafletScope(),b=v[e];y.getMap().then(function(r){var a=o.getDefaults(i.id);if(i[e].search("-")!==-1)return L.error(m+' The "center" variable can\'t use a "-" on its key name: "'+i[e]+'".'),void r.setView([a.center.lat,a.center.lng],a.center.zoom);if(h(v.bounds,b))r.fitBounds(l.createLeafletBounds(v.bounds),v.bounds.options),b=r.getCenter(),p(v,function(a){angular.extend(a[e],{lat:r.getCenter().lat,lng:r.getCenter().lng,zoom:r.getZoom(),autoDiscover:!1})}),p(v,function(e){var a=r.getBounds();e.bounds={northEast:{lat:a._northEast.lat,lng:a._northEast.lng},southWest:{lat:a._southWest.lat,lng:a._southWest.lng}}});else{if(!c(b))return L.error(m+' The "center" property is not defined in the main scope'),void r.setView([a.center.lat,a.center.lng],a.center.zoom);c(b.lat)&&c(b.lng)||c(b.autoDiscover)||angular.copy(a.center,b)}var y,k;if("yes"===i.urlHashCenter){var A=function(){var e,r=t.search();if(c(r.c)){var a=r.c.split(":");3===a.length&&(e={lat:parseFloat(a[0]),lng:parseFloat(a[1]),zoom:parseInt(a[2],10)})}return e};y=A(),v.$on("$locationChangeSuccess",function(a){var t=a.currentScope,n=A();c(n)&&!f(n,r)&&angular.extend(t[e],{lat:n.lat,lng:n.lng,zoom:n.zoom})})}v.$watch(e,function(e){if(!v.settingCenterFromLeaflet)return c(y)&&(angular.copy(y,e),y=void 0),g(e)||e.autoDiscover===!0?e.autoDiscover===!0?(d(e.zoom)||r.setView([a.center.lat,a.center.lng],a.center.zoom),void(d(e.zoom)&&e.zoom>a.center.zoom?r.locate({setView:!0,maxZoom:e.zoom}):c(a.maxZoom)?r.locate({setView:!0,maxZoom:a.maxZoom}):r.locate({setView:!0}))):void(k&&f(e,r)||(v.settingCenterFromScope=!0,r.setView([e.lat,e.lng],e.zoom),s.notifyCenterChangedToBounds(v,r),n(function(){v.settingCenterFromScope=!1}))):void L.warn(m+" invalid 'center'")},!0),r.whenReady(function(){k=!0}),r.on("moveend",function(){u.resolve(),s.notifyCenterUrlHashChanged(v,r,i,t.search()),f(b,r)||v.settingCenterFromScope||(v.settingCenterFromLeaflet=!0,p(v,function(a){v.settingCenterFromScope||angular.extend(a[e],{lat:r.getCenter().lat,lng:r.getCenter().lng,zoom:r.getZoom(),autoDiscover:!1}),s.notifyCenterChangedToBounds(v,r),n(function(){v.settingCenterFromLeaflet=!1})}))}),b.autoDiscover===!0&&r.on("locationerror",function(){L.warn(m+" The Geolocation API is unauthorized on this page."),g(b)?(r.setView([b.lat,b.lng],b.zoom),s.notifyCenterChangedToBounds(v,r)):(r.setView([a.center.lat,a.center.lng],a.center.zoom),s.notifyCenterChangedToBounds(v,r))})})}}}]}),centerDirectiveTypes.forEach(function(e){angular.module("ui-leaflet").directive(e,centerDirectives[e])}),angular.module("ui-leaflet").directive("controls",["leafletLogger","leafletHelpers","leafletControlHelpers",function(e,r,a){var t=e;return{restrict:"A",scope:!1,replace:!1,require:"?^leaflet",link:function(e,n,o,i){if(i){var l=a.createControl,s=a.isValidControlType,u=i.getLeafletScope(),c=r.isDefined,d=r.isArray,f={},p=r.errorHeader+" [Controls] ";i.getMap().then(function(e){u.$watchCollection("controls",function(r){for(var a in f)c(r[a])||(e.hasControl(f[a])&&e.removeControl(f[a]),delete f[a]);for(var n in r){var o,i=c(r[n].type)?r[n].type:n;if(!s(i))return void t.error(p+" Invalid control type: "+i+".");if("custom"!==i)o=l(i,r[n]),e.addControl(o),f[n]=o;else{var u=r[n];if(d(u))for(var g in u){var y=u[g];e.addControl(y),f[n]=c(f[n])?f[n].concat([y]):[y]}else e.addControl(u),f[n]=u}}})})}}}}]),angular.module("ui-leaflet").directive("decorations",["leafletLogger","leafletHelpers",function(e,r){var a=e;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,t,n,o){function i(e){return c(e)&&c(e.coordinates)&&(u.isLoaded()||a.error("[AngularJS - Leaflet] The PolylineDecorator Plugin is not loaded.")),L.polylineDecorator(e.coordinates)}function l(e,r){if(c(e)&&c(r)&&c(r.coordinates)&&c(r.patterns))return e.setPaths(r.coordinates),e.setPatterns(r.patterns),e}var s=o.getLeafletScope(),u=r.PolylineDecoratorPlugin,c=r.isDefined,d={};o.getMap().then(function(e){s.$watch("decorations",function(r){for(var a in d)c(r[a])&&angular.equals(r[a],d)||(e.removeLayer(d[a]),delete d[a]);for(var t in r){var n=r[t],o=i(n);c(o)&&(d[t]=o,e.addLayer(o),l(o,n))}},!0)})}}}]),angular.module("ui-leaflet").directive("eventBroadcast",["leafletLogger","$rootScope","leafletHelpers","leafletMapEvents","leafletIterators",function(e,r,a,t,n){var o=e;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,r,i,l){var s=a.isObject,u=a.isDefined,c=l.getLeafletScope(),d=c.eventBroadcast,f=t.getAvailableMapEvents(),p=t.addEvents;l.getMap().then(function(e){var r=[],a="broadcast";u(d.map)?s(d.map)?("emit"!==d.map.logic&&"broadcast"!==d.map.logic?o.warn("[AngularJS - Leaflet] Available event propagation logic are: 'emit' or 'broadcast'."):a=d.map.logic,s(d.map.enable)&&d.map.enable.length>=0?n.each(d.map.enable,function(e){r.indexOf(e)===-1&&f.indexOf(e)!==-1&&r.push(e)}):o.warn("[AngularJS - Leaflet] event-broadcast.map.enable must be an object check your model.")):o.warn("[AngularJS - Leaflet] event-broadcast.map must be an object check your model."):r=f,p(e,r,"eventName",c,a)})}}}]),angular.module("ui-leaflet").directive("geojson",["leafletLogger","$rootScope","leafletData","leafletHelpers","leafletWatchHelpers","leafletDirectiveControlsHelpers","leafletIterators","leafletGeoJsonEvents",function(e,r,a,t,n,o,i,l){var s=n.maybeWatch,u=t.watchOptions,c=o.extend,d=t,f=i;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,r,n,o){var i=t.isDefined,p=o.getLeafletScope(),g={},y=!1;o.getMap().then(function(e){var r=p.geojsonWatchOptions||u,o=function(e,r){var a;return a=angular.isFunction(e.onEachFeature)?e.onEachFeature:function(a,o){t.LabelPlugin.isLoaded()&&i(a.properties.description)&&o.bindLabel(a.properties.description),l.bindEvents(n.id,o,null,a,p,r,{resetStyleOnMouseout:e.resetStyleOnMouseout,mapId:n.id})}},v=d.isDefined(n.geojsonNested)&&d.isTruthy(n.geojsonNested),m=function(){if(g){var r=function(r){i(r)&&e.hasLayer(r)&&e.removeLayer(r)};return v?void f.each(g,function(e){r(e)}):void r(g)}},h=function(r,t){var l=angular.copy(r);if(i(l)&&i(l.data)){var s=o(l,t);i(l.options)||(l.options={style:l.style,filter:l.filter,onEachFeature:s,pointToLayer:l.pointToLayer});var u=L.geoJson(l.data,l.options);t&&d.isString(t)?g[t]=u:g=u,u.addTo(e),y||(y=!0,a.setGeoJSON(g,n.id))}},b=function(e){if(m(),v){if(!e||!Object.keys(e).length)return;return void f.each(e,function(e,r){h(e,r)})}h(e)};c(n.id,"geojson",b,m),s(p,"geojson",r,function(e){b(e)})})}}}]),angular.module("ui-leaflet").directive("layercontrol",["$filter","leafletLogger","leafletData","leafletHelpers",function(e,r,a,t){var n=r;return{restrict:"E",scope:{icons:"=?",autoHideOpacity:"=?",showGroups:"=?",title:"@",baseTitle:"@",overlaysTitle:"@"},replace:!0,transclude:!1,require:"^leaflet",controller:["$scope","$element","$sce",function(e,r,o){n.debug("[Angular Directive - Layers] layers",e,r);var i=t.safeApply,l=t.isDefined;angular.extend(e,{baselayer:"",oldGroup:"",layerProperties:{},groupProperties:{},rangeIsSupported:t.rangeIsSupported(),changeBaseLayer:function(r,n){t.safeApply(e,function(t){t.baselayer=r,a.getMap().then(function(n){a.getLayers().then(function(a){if(!n.hasLayer(a.baselayers[r])){for(var o in t.layers.baselayers)t.layers.baselayers[o].icon=t.icons.unradio,n.hasLayer(a.baselayers[o])&&n.removeLayer(a.baselayers[o]);n.addLayer(a.baselayers[r]),t.layers.baselayers[r].icon=e.icons.radio}})})}),n.preventDefault()},moveLayer:function(r,a,t){var n=Object.keys(e.layers.baselayers).length;if(a>=1+n&&a<=e.overlaysArray.length+n){var o;for(var l in e.layers.overlays)if(e.layers.overlays[l].index===a){o=e.layers.overlays[l];break}o&&i(e,function(){o.index=r.index,r.index=a})}t.stopPropagation(),t.preventDefault()},initIndex:function(r,a){var t=Object.keys(e.layers.baselayers).length;r.index=l(r.index)?r.index:a+t+1},initGroup:function(r){e.groupProperties[r]=e.groupProperties[r]?e.groupProperties[r]:{}},toggleOpacity:function(r,a){if(a.visible){if(e.autoHideOpacity&&!e.layerProperties[a.name].opacityControl)for(var t in e.layerProperties)e.layerProperties[t].opacityControl=!1;e.layerProperties[a.name].opacityControl=!e.layerProperties[a.name].opacityControl}r.stopPropagation(),r.preventDefault()},toggleLegend:function(r){e.layerProperties[r.name].showLegend=!e.layerProperties[r.name].showLegend},showLegend:function(r){return r.legend&&e.layerProperties[r.name].showLegend},unsafeHTML:function(e){return o.trustAsHtml(e)},getOpacityIcon:function(r){return r.visible&&e.layerProperties[r.name].opacityControl?e.icons.close:e.icons.open},getGroupIcon:function(r){return r.visible?e.icons.check:e.icons.uncheck},changeOpacity:function(r){var t=e.layerProperties[r.name].opacity;a.getMap().then(function(n){a.getLayers().then(function(a){var o;for(var i in e.layers.overlays)if(e.layers.overlays[i]===r){o=a.overlays[i];break}n.hasLayer(o)&&(o.setOpacity&&o.setOpacity(t/100),o.getLayers&&o.eachLayer&&o.eachLayer(function(e){e.setOpacity&&e.setOpacity(t/100)}))})})},changeGroupVisibility:function(r){if(l(e.groupProperties[r])){var a=e.groupProperties[r].visible;for(var t in e.layers.overlays){var n=e.layers.overlays[t];n.group===r&&(n.visible=a)}}}});var s=r.get(0);L.Browser.touch?L.DomEvent.on(s,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(s),L.DomEvent.on(s,"mousewheel",L.DomEvent.stopPropagation))}],template:'<div class="angular-leaflet-control-layers" ng-show="overlaysArray.length"><h4 ng-if="title">{{ title }}</h4><div class="lf-baselayers"><h5 class="lf-title" ng-if="baseTitle">{{ baseTitle }}</h5><div class="lf-row" ng-repeat="(key, layer) in baselayersArray"><label class="lf-icon-bl" ng-click="changeBaseLayer(key, $event)"><input class="leaflet-control-layers-selector" type="radio" name="lf-radio" ng-show="false" ng-checked="baselayer === key" ng-value="key" /> <i class="lf-icon lf-icon-radio" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label></div></div><div class="lf-overlays"><h5 class="lf-title" ng-if="overlaysTitle">{{ overlaysTitle }}</h5><div class="lf-container"><div class="lf-row" ng-repeat="layer in (o = (overlaysArray | orderBy:\'index\':order))" ng-init="initIndex(layer, $index)"><label class="lf-icon-ol-group" ng-if="showGroups &amp;&amp; layer.group &amp;&amp; layer.group != o[$index-1].group"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-change="changeGroupVisibility(layer.group)" ng-model="groupProperties[layer.group].visible"/> <i class="lf-icon lf-icon-check" ng-class="getGroupIcon(groupProperties[layer.group])"></i><div class="lf-text">{{ layer.group }}</div></label><label class="lf-icon-ol"><input class="lf-control-layers-selector" type="checkbox" ng-show="false" ng-model="layer.visible"/> <i class="lf-icon lf-icon-check" ng-class="layer.icon"></i><div class="lf-text">{{layer.name}}</div></label><div class="lf-icons"><i class="lf-icon lf-up" ng-class="icons.up" ng-click="moveLayer(layer, layer.index - orderNumber, $event)"></i> <i class="lf-icon lf-down" ng-class="icons.down" ng-click="moveLayer(layer, layer.index + orderNumber, $event)"></i> <i class="lf-icon lf-toggle-legend" ng-class="icons.toggleLegend" ng-if="layer.legend" ng-click="toggleLegend(layer)"></i> <i class="lf-icon lf-open" ng-class="getOpacityIcon(layer)" ng-click="toggleOpacity($event, layer)"></i></div><div class="lf-legend" ng-if="showLegend(layer)" ng-bind-html="unsafeHTML(layer.legend)"></div><div class="lf-opacity clearfix" ng-if="layer.visible &amp;&amp; layerProperties[layer.name].opacityControl"><label ng-if="rangeIsSupported" class="pull-left" style="width: 50%">0</label><label ng-if="rangeIsSupported" class="pull-left text-right" style="width: 50%">100</label><input ng-if="rangeIsSupported" class="clearfix" type="range" min="0" max="100" class="lf-opacity-control" ng-model="layerProperties[layer.name].opacity" ng-change="changeOpacity(layer)"/><h6 ng-if="!rangeIsSupported">Range is not supported in this browser</h6></div></div></div></div></div>',link:function(e,r,n,o){var i=t.isDefined,l=o.getLeafletScope(),s=l.layers;e.$watch("icons",function(){var r={uncheck:"fa fa-square-o",check:"fa fa-check-square-o",radio:"fa fa-dot-circle-o",unradio:"fa fa-circle-o",up:"fa fa-angle-up",down:"fa fa-angle-down",open:"fa fa-angle-double-down",close:"fa fa-angle-double-up",toggleLegend:"fa fa-pencil-square-o"};i(e.icons)?(angular.extend(r,e.icons),angular.extend(e.icons,r)):e.icons=r}),n.order=!i(n.order)||"normal"!==n.order&&"reverse"!==n.order?"normal":n.order,e.order="normal"===n.order,e.orderNumber="normal"===n.order?-1:1,e.layers=s,o.getMap().then(function(r){l.$watch("layers.baselayers",function(t){var n={};a.getLayers().then(function(a){var o;for(o in t){var i=t[o];i.icon=e.icons[r.hasLayer(a.baselayers[o])?"radio":"unradio"],n[o]=i}e.baselayersArray=n})}),l.$watch("layers.overlays",function(r){var t=[],n={};a.getLayers().then(function(a){var o;for(o in r){var l=r[o];l.icon=e.icons[l.visible?"check":"uncheck"],t.push(l),i(e.layerProperties[l.name])||(e.layerProperties[l.name]={opacity:i(l.layerOptions.opacity)?100*l.layerOptions.opacity:100,opacityControl:!1,showLegend:!0}),i(l.group)&&(i(e.groupProperties[l.group])||(e.groupProperties[l.group]={visible:!1}),n[l.group]=i(n[l.group])?n[l.group]:{count:0,visibles:0},n[l.group].count++,l.visible&&n[l.group].visibles++),i(l.index)&&a.overlays[o].setZIndex&&a.overlays[o].setZIndex(r[o].index)}for(o in n)e.groupProperties[o].visible=n[o].visibles===n[o].count;e.overlaysArray=t})},!0)})}}}]),angular.module("ui-leaflet").directive("layers",["leafletLogger","$q","leafletData","leafletHelpers","leafletLayerHelpers","leafletControlHelpers",function(e,r,a,t,n,o){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",controller:["$scope",function(e){e._leafletLayers=r.defer(),this.getLayers=function(){return e._leafletLayers.promise}}],link:function(e,r,i,l){var s=t.isDefined,u={},c=l.getLeafletScope(),d=c.layers,f=n.createLayer,p=n.safeAddLayer,g=n.safeRemoveLayer,y=o.updateLayersControl,v=!1;l.getMap().then(function(r){e._leafletLayers.resolve(u),a.setLayers(u,i.id),u.baselayers={},u.overlays={};var t=i.id,n=!1;for(var o in d.baselayers){var l=f(d.baselayers[o]);s(l)?(u.baselayers[o]=l,d.baselayers[o].top===!0&&(p(r,u.baselayers[o]),n=!0)):delete d.baselayers[o]}!n&&Object.keys(u.baselayers).length>0&&p(r,u.baselayers[Object.keys(d.baselayers)[0]]);for(o in d.overlays){"cartodb"===d.overlays[o].type;var m=f(d.overlays[o]);s(m)?(u.overlays[o]=m,d.overlays[o].visible===!0&&p(r,u.overlays[o])):delete d.overlays[o]}c.$watch("layers.baselayers",function(e,a){if(angular.equals(e,a))return v=y(r,t,v,e,d.overlays,u),!0;for(var n in u.baselayers)s(e[n])&&!e[n].doRefresh||(r.hasLayer(u.baselayers[n])&&r.removeLayer(u.baselayers[n]),
delete u.baselayers[n],e[n]&&e[n].doRefresh&&(e[n].doRefresh=!1));for(var o in e)if(s(u.baselayers[o]))e[o].top!==!0||r.hasLayer(u.baselayers[o])?e[o].top===!1&&r.hasLayer(u.baselayers[o])&&r.removeLayer(u.baselayers[o]):p(r,u.baselayers[o]);else{var i=f(e[o]);s(i)&&(u.baselayers[o]=i,e[o].top===!0&&p(r,u.baselayers[o]))}var l=!1;for(var c in u.baselayers)if(r.hasLayer(u.baselayers[c])){l=!0;break}!l&&Object.keys(u.baselayers).length>0&&p(r,u.baselayers[Object.keys(u.baselayers)[0]]),v=y(r,t,v,e,d.overlays,u)},!0),c.$watch("layers.overlays",function(e,a){if(angular.equals(e,a))return v=y(r,t,v,d.baselayers,e,u),!0;for(var n in u.overlays)if(!s(e[n])||e[n].doRefresh){if(r.hasLayer(u.overlays[n])){var o=s(e[n])?e[n].layerOptions:null;g(r,u.overlays[n],o)}delete u.overlays[n],e[n]&&e[n].doRefresh&&(e[n].doRefresh=!1)}for(var i in e){if(s(u.overlays[i]))e[i].visible&&!r.hasLayer(u.overlays[i])?p(r,u.overlays[i]):e[i].visible===!1&&r.hasLayer(u.overlays[i])&&g(r,u.overlays[i],e[i].layerOptions);else{var l=f(e[i]);if(!s(l))continue;u.overlays[i]=l,e[i].visible===!0&&p(r,u.overlays[i])}e[i].visible&&r._loaded&&e[i].data&&"heatmap"===e[i].type&&(u.overlays[i].setData(e[i].data),u.overlays[i].update())}v=y(r,t,v,d.baselayers,e,u)},!0)})}}}]),angular.module("ui-leaflet").directive("legend",["leafletLogger","$http","$timeout","leafletHelpers","leafletLegendHelpers",function(e,r,a,t,n){var o=e,i=t.errorHeader+" [Legend] ";return{restrict:"A",scope:!1,replace:!1,require:"leaflet",transclude:!1,link:function(e,r,a,l){var s,u,c,d,f=t.isArray,p=t.isString,g=t.isDefined,y=t.isFunction,v=l.getLeafletScope(),m=v.legend;v.$watch("legend",function(e){g(e)&&(s=e.legendClass?e.legendClass:"legend",u=e.position||"bottomright",d=e.type||"arcgis")},!0);var h=function(e,r,a){r&&r.layers&&r.layers.length>0&&(g(c)?n.updateLegend(c.getContainer(),r,d,a):(c=L.control({position:u}),c.onAdd=n.getOnAddLegend(r,s,d,a),c.addTo(e)),g(m.loadedData)&&y(m.loadedData)&&m.loadedData())};l.getMap().then(function(e){v.$watch("legend",function(r){return g(r)?g(r.url)||"arcgis"!==d||f(r.colors)&&f(r.labels)&&r.colors.length===r.labels.length?g(r.url)?void o.info(i+" loading legend service."):(g(c)&&(c.removeFrom(e),c=null),c=L.control({position:u}),"arcgis"===d&&(c.onAdd=n.getOnAddArrayLegend(r,s)),void c.addTo(e)):void o.warn(i+" legend.colors and legend.labels must be set."):void(g(c)&&(c.removeFrom(e),c=null))}),v.$watch("legend.url",function(r){if(g(r)){if(!f(r)&&!p(r))return void o.warn(i+" legend.url must be an array or string.");for(var t,l=p(r)?[r]:r,s=function(a,n){return function(s){g(s.data.error)?o.warn(i+"Error loadin legend from: "+n,s.data.error.message):t&&t.layers&&t.layers.length>0?t.layers=t.layers.concat(s.data.layers):t=s.data,a===l.length-1&&h(e,t,r)}},u=function(e){o.warn(i+" legend.url not loaded.",e)},c=0;c<l.length;c++)n.addLegendURL(a.id,{url:l[c],method:"GET"}).then(s(c)).catch(u)}}),v.$watch("legend.legendData",function(r){o.debug("legendData",r),!g(v.legend.url)&&g(r)&&h(e,r)},!0)})}}}]),angular.module("ui-leaflet").directive("markers",["leafletLogger","$rootScope","$q","leafletData","leafletHelpers","leafletMapDefaults","leafletMarkersHelpers","leafletMarkerEvents","leafletIterators","leafletWatchHelpers","leafletDirectiveControlsHelpers",function(e,r,a,t,n,o,i,l,s,u,c){var d=n.isDefined,f=n.errorHeader,p=n,g=n.isString,y=i.addMarkerWatcher,v=i.updateMarker,m=i.listenMarkerEvents,h=i.addMarkerToGroup,b=i.createMarker,k=i.deleteMarker,A=i.getModelFromModels,D=i.getLayerModels,w=s,P=n.watchOptions,C=u.maybeWatch,M=c.extend,H=e,O=function(e,r,a){if(Object.keys(e).length){if(a&&g(a)){if(!e[a]||!Object.keys(e[a]).length)return;return e[a][r]}return e[r]}},S=function(e,r,a,t){return t&&g(t)?(d(r[t])||(r[t]={}),r[t][a]=e):r[a]=e,e},E=function(e,r,a,t,n,o){if(!g(e))return H.error(f+" A layername must be a string"),!1;if(!d(r))return H.error(f+" You must add layers to the directive if the markers are going to use this functionality."),!1;if(!d(r.overlays)||!d(r.overlays[e]))return H.error(f+' A marker can only be added to a layer of type "group"'),!1;var i=r.overlays[e];return i instanceof L.LayerGroup||i instanceof L.FeatureGroup?(i.addLayer(t),!n&&o.hasLayer(t)&&a.focus===!0&&t.openPopup(),!0):(H.error(f+' Adding a marker to an overlay needs a overlay of the type "group" or "featureGroup"'),!1)},T=function(e,r,a,t,n,o,i,s,u,c){for(var g in r)if(!c[g])if(g.search("-")===-1){var L=p.copy(r[g]),k=p.getObjectDotPath(u?[u,g]:[g]),D=O(o,g,u);if(d(D)){var w=A(a,g,u);v(L,w,D,k,i,n,t)}else{var P=b(L),C=(L?L.layer:void 0)||u;if(!d(P)){H.error(f+" Received invalid data on the marker "+g+".");continue}if(S(P,o,g,u),d(L.message)&&P.bindPopup(L.message,L.popupOptions),d(L.group)){var M=d(L.groupOption)?L.groupOption:null;h(P,L.group,M,t)}if(p.LabelPlugin.isLoaded()&&d(L.label)&&d(L.label.message)&&P.bindLabel(L.label.message,L.label.options),d(L)&&(d(L.layer)||d(u))){var T=E(C,n,L,P,s.individual.doWatch,t);if(!T)continue}else d(L.group)||(t.addLayer(P),s.individual.doWatch||L.focus!==!0||P.openPopup());s.individual.doWatch&&y(P,k,i,n,t,s.individual.isDeep),m(P,L,i,s.individual.doWatch,t),l.bindEvents(e,P,k,L,i,C)}}else H.error('The marker can\'t use a "-" on his key name: "'+g+'".')},x=function(e,r,a,t,n){var o,i,l=!1,s=!1,u=d(r);for(var c in a)l||(H.debug(f+"[markers] destroy: "),l=!0),u&&(i=e[c],o=r[c],s=angular.equals(i,o)&&t),d(e)&&Object.keys(e).length&&d(e[c])&&Object.keys(e[c]).length&&!s||n&&p.isFunction(n)&&n(i,o,c)},B=function(e,r,a,t,n){x(e,r,a,!1,function(e,r,o){H.debug(f+"[marker] is deleting marker: "+o),k(a[o],t,n),delete a[o]})},G=function(e,r,a){var t={};return x(e,r,a,!0,function(e,r,a){H.debug(f+"[marker] is already rendered, marker: "+a),t[a]=e}),t};return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(e,r,n,o){var i=o[0],l=i.getLeafletScope();i.getMap().then(function(e){var r,i={};r=d(o[1])?o[1].getLayers:function(){var e=a.defer();return e.resolve(),e.promise};var s=l.markersWatchOptions||P;d(n.watchMarkers)&&(s.doWatch=s.individual.doWatch=!d(n.watchMarkers)||p.isTruthy(n.watchMarkers));var u=d(n.markersNested)&&p.isTruthy(n.markersNested);r().then(function(r){var a=function(a,t){return u?void w.each(a,function(a,n){var o=D(t,n);B(a,o,i[n],e,r)}):void B(a,t,i,e,r)},o=function(t,o){a(t,o);var c=null;return u?void w.each(t,function(a,u){var d=D(o,u),f=D(t,u);c=G(f,d,i[u]),T(n.id,a,o,e,r,i,l,s,u,c)}):(c=G(t,o,i),void T(n.id,t,o,e,r,i,l,s,void 0,c))};M(n.id,"markers",o,a),t.setMarkers(i,n.id),C(l,"markers",s,function(e,r){o(e,r)})})})}}}]),angular.module("ui-leaflet").directive("maxbounds",["leafletLogger","leafletMapDefaults","leafletBoundsHelpers","leafletHelpers",function(e,r,a,t){return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,r,n,o){var i=o.getLeafletScope(),l=a.isValidBounds,s=t.isNumber;o.getMap().then(function(e){i.$watch("maxbounds",function(r){if(!l(r))return void e.setMaxBounds();var t=a.createLeafletBounds(r);s(r.pad)&&(t=t.pad(r.pad)),e.setMaxBounds(t),n.center||n.lfCenter||e.fitBounds(t)})})}}}]),angular.module("ui-leaflet").directive("paths",["leafletLogger","$q","leafletData","leafletMapDefaults","leafletHelpers","leafletPathsHelpers","leafletPathEvents",function(e,r,a,t,n,o,i){var l=e;return{restrict:"A",scope:!1,replace:!1,require:["leaflet","?layers"],link:function(e,s,u,c){var d=c[0],f=n.isDefined,p=n.isString,g=d.getLeafletScope(),y=g.paths,v=o.createPath,m=i.bindPathEvents,h=o.setPathOptions;d.getMap().then(function(e){var o,i=t.getDefaults(u.id);o=f(c[1])?c[1].getLayers:function(){var e=r.defer();return e.resolve(),e.promise},f(y)&&o().then(function(r){var t={};a.setPaths(t,u.id);var o=!f(u.watchPaths)||"true"===u.watchPaths,s=function(a,t){var n=g.$watch('paths["'+t+'"]',function(t,o){if(!f(t)){if(f(o.layer))for(var i in r.overlays){var l=r.overlays[i];l.removeLayer(a)}return e.removeLayer(a),void n()}h(a,t.type,t)},!0)};g.$watchCollection("paths",function(a){for(var c in t)f(a[c])||(e.removeLayer(t[c]),delete t[c]);for(var d in a)if(0!==d.search("\\$"))if(d.search("-")===-1){if(!f(t[d])){var y=a[d],b=v(d,a[d],i);if(f(b)&&f(y.message)&&b.bindPopup(y.message,y.popupOptions),n.LabelPlugin.isLoaded()&&f(y.label)&&f(y.label.message)&&b.bindLabel(y.label.message,y.label.options),f(y)&&f(y.layer)){if(!p(y.layer)){l.error("[AngularJS - Leaflet] A layername must be a string");continue}if(!f(r)){l.error("[AngularJS - Leaflet] You must add layers to the directive if the markers are going to use this functionality.");continue}if(!f(r.overlays)||!f(r.overlays[y.layer])){l.error('[AngularJS - Leaflet] A path can only be added to a layer of type "group"');continue}var k=r.overlays[y.layer];if(!(k instanceof L.LayerGroup||k instanceof L.FeatureGroup)){l.error('[AngularJS - Leaflet] Adding a path to an overlay needs a overlay of the type "group" or "featureGroup"');continue}t[d]=b,k.addLayer(b),o?s(b,d):h(b,y.type,y)}else f(b)&&(t[d]=b,e.addLayer(b),o?s(b,d):h(b,y.type,y));m(u.id,b,d,y,g)}}else l.error('[AngularJS - Leaflet] The path name "'+d+'" is not valid. It must not include "-" and a number.')})})})}}}]),angular.module("ui-leaflet").directive("tiles",["leafletLogger","leafletData","leafletMapDefaults","leafletHelpers",function(e,r,a,t){var n=e;return{restrict:"A",scope:!1,replace:!1,require:"leaflet",link:function(e,o,i,l){var s=t.isDefined,u=l.getLeafletScope(),c=u.tiles;return s(c)&&s(c.url)?void l.getMap().then(function(e){var t,n=a.getDefaults(i.id);u.$watch("tiles",function(a){var o=n.tileLayerOptions,l=n.tileLayer;return!s(a.url)&&s(t)?void e.removeLayer(t):s(t)?s(a.url)&&s(a.options)&&!angular.equals(a.options,o)?(e.removeLayer(t),o=n.tileLayerOptions,angular.copy(a.options,o),l=a.url,t=L.tileLayer(l,o),t.addTo(e),void r.setTiles(t,i.id)):void(s(a.url)&&t.setUrl(a.url)):(s(a.options)&&angular.copy(a.options,o),s(a.url)&&(l=a.url),t=L.tileLayer(l,o),t.addTo(e),void r.setTiles(t,i.id))},!0)}):void n.warn("[AngularJS - Leaflet] The 'tiles' definition doesn't have the 'url' property.")}}}]),["markers","geojson"].forEach(function(e){angular.module("ui-leaflet").directive(e+"WatchOptions",["$log","$rootScope","$q","leafletData","leafletHelpers",function(r,a,t,n,o){var i=o.isDefined,l=o.errorHeader,s=o.isObject,u=o.watchOptions,c=r;return{restrict:"A",scope:!1,replace:!1,require:["leaflet"],link:function(r,a,t,n){var o=n[0],d=o.getLeafletScope();o.getMap().then(function(){i(r[e+"WatchOptions"])&&(s(r[e+"WatchOptions"])?angular.extend(u,r[e+"WatchOptions"]):c.error(l+"["+e+"WatchOptions] is not an object"),d[e+"WatchOptions"]=u)})}}}])}),angular.module("ui-leaflet").factory("leafletEventsHelpersFactory",["$rootScope","$q","leafletLogger","leafletHelpers",function(e,r,a,t){var n=t.safeApply,o=t.isDefined,i=t.isObject,l=t.isArray,s=t.errorHeader,u=a,c=function(e,r){this.rootBroadcastName=e,u.debug("leafletEventsHelpersFactory: lObjectType: "+r+"rootBroadcastName: "+e),this.lObjectType=r};return c.prototype.getAvailableEvents=function(){return[]},c.prototype.genDispatchEvent=function(e,r,a,t,n,o,i,l,s){var c=this;return e=e||"",e&&(e="."+e),function(d){var f=c.rootBroadcastName+e+"."+r;u.debug(f),c.fire(t,f,a,d,d.target||n,i,o,l,s)}},c.prototype.fire=function(r,a,t,i,l,s,u,c,d){n(r,function(){var n={leafletEvent:i,leafletObject:l,modelName:u,model:s};o(c)&&angular.extend(n,{layerName:c}),"emit"===t?r.$emit(a,n):e.$broadcast(a,n)})},c.prototype.bindEvents=function(e,r,a,t,n,c,d){var f=[],p="emit",g=this;if(o(n.eventBroadcast))if(i(n.eventBroadcast))if(o(n.eventBroadcast[g.lObjectType]))if(i(n.eventBroadcast[g.lObjectType])){o(n.eventBroadcast[this.lObjectType].logic)&&"emit"!==n.eventBroadcast[g.lObjectType].logic&&"broadcast"!==n.eventBroadcast[g.lObjectType].logic&&u.warn(s+"Available event propagation logic are: 'emit' or 'broadcast'.");var y=!1,v=!1;o(n.eventBroadcast[g.lObjectType].enable)&&l(n.eventBroadcast[g.lObjectType].enable)&&(y=!0),o(n.eventBroadcast[g.lObjectType].disable)&&l(n.eventBroadcast[g.lObjectType].disable)&&(v=!0),y&&v?u.warn(s+"can not enable and disable events at the same time"):y||v?y?n.eventBroadcast[this.lObjectType].enable.forEach(function(e){f.indexOf(e)!==-1?u.warn(s+"This event "+e+" is already enabled"):g.getAvailableEvents().indexOf(e)===-1?u.warn(s+"This event "+e+" does not exist"):f.push(e)}):(f=this.getAvailableEvents(),n.eventBroadcast[g.lObjectType].disable.forEach(function(e){var r=f.indexOf(e);r===-1?u.warn(s+"This event "+e+" does not exist or has been already disabled"):f.splice(r,1)})):u.warn(s+"must enable or disable events")}else u.warn(s+"event-broadcast."+[g.lObjectType]+" must be an object check your model.");else f=this.getAvailableEvents();else u.error(s+"event-broadcast must be an object check your model.");else f=this.getAvailableEvents();return f.forEach(function(o){r.on(o,g.genDispatchEvent(e,o,p,n,r,a,t,c,d))}),p},c}]).service("leafletEventsHelpers",["leafletEventsHelpersFactory",function(e){return new e}]),angular.module("ui-leaflet").factory("leafletGeoJsonEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletEventsHelpersFactory","leafletData",function(e,r,a,t,n,o){var i=t.safeApply,l=n,s=function(){l.call(this,"leafletDirectiveGeoJson","geojson")};return s.prototype=new l,s.prototype.genDispatchEvent=function(r,a,t,n,s,u,c,d,f){var p=l.prototype.genDispatchEvent.call(this,r,a,t,n,s,u,c,d),g=this;return function(r){"mouseout"===a&&(f.resetStyleOnMouseout&&o.getGeoJSON(f.mapId).then(function(e){var a=d?e[d]:e;a.resetStyle(r.target)}),i(n,function(){e.$broadcast(g.rootBroadcastName+".mouseout",r)})),p(r)}},s.prototype.getAvailableEvents=function(){return["click","dblclick","mouseover","mouseout"]},new s}]),angular.module("ui-leaflet").factory("leafletLabelEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletEventsHelpersFactory",function(e,r,a,t,n){var o=t,i=n,l=function(){i.call(this,"leafletDirectiveLabel","markers")};return l.prototype=new i,l.prototype.genDispatchEvent=function(e,r,a,t,n,o,l,s){var u=o.replace("markers.","");return i.prototype.genDispatchEvent.call(this,e,r,a,t,n,u,l,s)},l.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu"]},l.prototype.genEvents=function(e,r,a,t,n,i,l,s){var u=this,c=this.getAvailableEvents(),d=o.getObjectArrayPath("markers."+i);c.forEach(function(r){n.label.on(r,u.genDispatchEvent(e,r,a,t,n.label,d,l,s))})},l.prototype.bindEvents=function(e,r,a,t,n,o){},new l}]),angular.module("ui-leaflet").factory("leafletMapEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletEventsHelpers","leafletIterators",function(e,r,a,t,n,o){var i=t.isDefined,l=n.fire,s=function(){return["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","focus","blur","preclick","load","unload","viewreset","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoomanim","zoomend","zoomlevelschange","resize","autopanstart","layeradd","layerremove","baselayerchange","overlayadd","overlayremove","locationfound","locationerror","popupopen","popupclose","draw:created","draw:edited","draw:deleted","draw:drawstart","draw:drawstop","draw:editstart","draw:editstop","draw:deletestart","draw:deletestop"]},u=function(e,r,t,n){return n&&(n+="."),function(o){var i="leafletDirectiveMap."+n+r;a.debug(i),l(e,i,t,o,o.target,e)}},c=function(e){e.$broadcast("boundsChanged")},d=function(e,r,a,t){if(i(a.urlHashCenter)){var n=r.getCenter(),o=n.lat.toFixed(4)+":"+n.lng.toFixed(4)+":"+r.getZoom();i(t.c)&&t.c===o||e.$emit("centerUrlHash",o)}},f=function(e,r,a,t,n){o.each(r,function(r){var o={};o[a]=r,e.on(r,u(t,r,n,e._container.id||""),o)})};return{getAvailableMapEvents:s,genDispatchMapEvent:u,notifyCenterChangedToBounds:c,notifyCenterUrlHashChanged:d,addEvents:f}}]),angular.module("ui-leaflet").factory("leafletMarkerEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletEventsHelpersFactory","leafletLabelEvents",function(e,r,a,t,n,o){var i=t.safeApply,l=t.isDefined,s=t,u=o,c=n,d=function(){c.call(this,"leafletDirectiveMarker","markers")};return d.prototype=new c,d.prototype.genDispatchEvent=function(r,a,t,n,o,l,s,u){var d=c.prototype.genDispatchEvent.call(this,r,a,t,n,o,l,s,u);return function(r){"click"===a?i(n,function(){e.$broadcast("leafletDirectiveMarkersClick",l)}):"dragend"===a&&(i(n,function(){s.lat=o.getLatLng().lat,s.lng=o.getLatLng().lng}),s.message&&s.focus===!0&&o.openPopup()),d(r)}},d.prototype.getAvailableEvents=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","dragstart","drag","dragend","move","remove","popupopen","popupclose","touchend","touchstart","touchmove","touchcancel","touchleave"]},d.prototype.bindEvents=function(e,r,a,t,n,o){var i=c.prototype.bindEvents.call(this,e,r,a,t,n,o);s.LabelPlugin.isLoaded()&&l(r.label)&&u.genEvents(e,a,i,n,r,t,o)},new d}]),angular.module("ui-leaflet").factory("leafletPathEvents",["$rootScope","$q","leafletLogger","leafletHelpers","leafletLabelEvents","leafletEventsHelpers",function(e,r,a,t,n,o){var i=t.isDefined,l=t.isObject,s=t,u=t.errorHeader,c=n,d=o.fire,f=a,p=function(e,r,a,t,n,o,i,l){return e=e||"",e&&(e="."+e),function(s){var u="leafletDirectivePath"+e+"."+r;f.debug(u),d(t,u,a,s,s.target||n,i,o,l)}},g=function(e,r,a,t,n){var o,d,g=[],v="broadcast";if(i(n.eventBroadcast))if(l(n.eventBroadcast))if(i(n.eventBroadcast.path))if(l(n.eventBroadcast.paths))f.warn(u+"event-broadcast.path must be an object check your model.");else{void 0!==n.eventBroadcast.path.logic&&null!==n.eventBroadcast.path.logic&&("emit"!==n.eventBroadcast.path.logic&&"broadcast"!==n.eventBroadcast.path.logic?f.warn(u+"Available event propagation logic are: 'emit' or 'broadcast'."):"emit"===n.eventBroadcast.path.logic&&(v="emit"));var m=!1,L=!1;if(void 0!==n.eventBroadcast.path.enable&&null!==n.eventBroadcast.path.enable&&"object"==typeof n.eventBroadcast.path.enable&&(m=!0),void 0!==n.eventBroadcast.path.disable&&null!==n.eventBroadcast.path.disable&&"object"==typeof n.eventBroadcast.path.disable&&(L=!0),m&&L)f.warn(u+"can not enable and disable events at the same time");else if(m||L)if(m)for(o=0;o<n.eventBroadcast.path.enable.length;o++)d=n.eventBroadcast.path.enable[o],g.indexOf(d)!==-1?f.warn(u+"This event "+d+" is already enabled"):y().indexOf(d)===-1?f.warn(u+"This event "+d+" does not exist"):g.push(d);else for(g=y(),o=0;o<n.eventBroadcast.path.disable.length;o++){d=n.eventBroadcast.path.disable[o];var h=g.indexOf(d);h===-1?f.warn(u+"This event "+d+" does not exist or has been already disabled"):g.splice(h,1)}else f.warn(u+"must enable or disable events")}else g=y();else f.error(u+"event-broadcast must be an object check your model.");else g=y();for(o=0;o<g.length;o++)d=g[o],r.on(d,p(e,d,v,n,g,a));s.LabelPlugin.isLoaded()&&i(r.label)&&c.genEvents(e,a,v,n,r,t)},y=function(){return["click","dblclick","mousedown","mouseover","mouseout","contextmenu","add","remove","popupopen","popupclose"]};return{getAvailablePathEvents:y,bindPathEvents:g}}])}(angular);